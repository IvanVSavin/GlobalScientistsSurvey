---
title: "Results of scientists survey"
author: "Ivan Savin"
date: "15/07/2022"
output: word_document

---

<style type="text/css">
body, td {
   font-size: 20px;
}
code.r{ / Code block /
    font-size: 6px;
}
</style>

```{r echo=FALSE}
rm(list=ls())
setwd("D:/Projects/3_CurrentProjects/Scientific survey")#D:/Scientific survey
sapply(c("magrittr", "data.table", 'plyr','dplyr', 'ggplot2', 'cluster','knitr', 'dendextend','pkgbuild','devtools','R.methodsS3','stm','ngram','matrixStats','corrplot','ggpubr','wordcloud','readxl','tm'), require, character.only = T)
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
library(webshot)
#webshot::install_phantomjs()

knitr::opts_chunk$set(fig.width=7, fig.height=5,dpi=300) #10 15

data<-read.csv('540850-data-data_spellcorrect_newclass.csv', header=T, sep=',')
data<-data[1:789,]
#table(data$Primary_research_field)

data$Primary_research_field[which(data$Primary_research_field=="Environmental economics")]<-"Env. economics"
data$Primary_research_field[which(data$Primary_research_field=="Ecological economics")]<-"Ecol. economics"
data$Primary_research_field[which(data$Primary_research_field=="Economics (other areas)")]<-"Oth. economics"
data$Primary_research_field[which(data$Primary_research_field=="Engineering")]<-"Engineering"
data$Primary_research_field[which(data$Primary_research_field=="Geography")]<-"Geography"
data$Primary_research_field[which(data$Primary_research_field=="Agri/forest")]<-"Agri./forestry"
data$Primary_research_field[which(data$Primary_research_field=="Law")]<-"Law"
data$Primary_research_field[which(data$Primary_research_field=="Mathematics and computer sciences")]<-"Math & comp. sci."
data$Primary_research_field[which(data$Primary_research_field=="Natural science (Atmospheric, Climate, etc.)")]<-"Natural sci."
data$Primary_research_field[which(data$Primary_research_field=="Political science")]<-"Political sci."
data$Primary_research_field[which(data$Primary_research_field=="Psychology")]<-"Psychology"
data$Primary_research_field[which(data$Primary_research_field=="Sociology")]<-"Sociology"
data$Primary_research_field[which(data$Primary_research_field=="Sustainability transition studies")]<-"Sust. transition"
data$Primary_research_field[which(data$Primary_research_field=="Oth Env Soc Sci")]<-"Oth. env. soc. sci."
data$Primary_research_field[which(data$Primary_research_field=="Industrial ecology")]<-"Ind. ecology"


listcountries<-read.csv('list of countries_2.csv', header=T, sep=',')

data$country_residence[c(6,8,14,23,25,38)]<-186
data$country_residence[c(211,224)]<-6
listcountries$IMF.GDPpc <- gsub(",", "", listcountries$IMF.GDPpc)

listcountries$IMF.GDPpc<-as.numeric(listcountries$IMF.GDPpc)
data$countryresGDPpc<-matrix(0,length(data$country_residence),1)
data$countryoriGDPpc<-matrix(0,length(data$country_residence),1)


data$countryoriGDPpc[which(data$country_origin==1)]<-listcountries$IMF.GDPpc[data$country_residence[which(data$country_origin==1)]]

for (i in 1:196){
data$countryresGDPpc[which(data$country_residence==i)]<-listcountries$IMF.GDPpc[i]
data$country_residence[which(data$country_residence==i)]<-listcountries$Country[i]
}
  
data$country_origin[which(data$country_origin==1)]<-data$country_residence[which(data$country_origin==1)]

for (i in 2:197){
data$countryoriGDPpc[which(data$country_origin==i)]<-listcountries$IMF.GDPpc[i-1]
data$country_origin[which(data$country_origin==i)]<-listcountries$Country[i-1]
}

data$politics[which(data$politics==99)]<-NA

data$climate_worry[which(data$climate_worry==99)]<-NA

data$GEM_1[which(data$GEM_1==8)]<-NA
data$GEM_2[which(data$GEM_2==8)]<-NA
data$GEM_3[which(data$GEM_3==8)]<-NA

data$criteria_1[which(data$criteria_1==6)]<-NA
data$criteria_2[which(data$criteria_2==6)]<-NA
data$criteria_3[which(data$criteria_3==6)]<-NA
data$criteria_4[which(data$criteria_4==6)]<-NA
data$criteria_5[which(data$criteria_5==6)]<-NA

for (ic in 27:57){
  data[which(data[,ic]==4),ic]<-NA
}

for (ic in 60:66){
  data[which(data[,ic]==6),ic]<-NA
}

colnames(data)[60:66]<-c("importantpolicies_1","importantpolicies_2","importantpolicies_3","importantpolicies_4","importantpolicies_5","importantpolicies_6","importantpolicies_7")

```

The average (median) length of the interview was 146 (21) minutes. Mainly because of a few outliers exceeding one million seconds(!)

Environmental economists and natural scientist are the most popular fields  of research for people participated in the survey.

Majority of our sample respondents are male, with mean (meadian) of 19 (15) years of research experience. majority of respodents tend to have leftish political views.

Scientists are mostly very or extremely concerned about climate change

Few countries (US, Germany, UK) as expected logically dominate among the places of residence and origin. 

I also cluster respondents. As 20 people answered "dont know" to at least 1 out of 3 statements, the sample here is reduced from 789 to 769 observations. Note that all there clustering methods (kmeans, hierarchical clustering and LCA speak for 3 clusters).

The number of Greengrowth opinions is 208 out of 769, Agrowth - 343 out of 769 and Degrwoth - 218 out of 769.
Males tend to have more leftish political views and degrowth opinion. Reearch experience and length of interview do not show large correlations

It is interesting that Green Growth views are much more concentrated in China, Greece and Nigeria, while almost absent in Sweden and Spain.
As for disciplines, Degrowth is stronger present in EcoEco, Law, Psychology and Sociology (see also regression result)

```{r, echo=FALSE}
summary(data)
#head(data)
summary(data$LENGTH_OF_INTERVIEW)
# 
# data$LENGTH_OF_INTERVIEW[which(data$LENGTH_OF_INTERVIEW==max(data$LENGTH_OF_INTERVIEW))]<-NA
# summary(data$LENGTH_OF_INTERVIEW)

par(mfrow = c(1,1) ,mar=c(10,4,1,2))

plot(table(data$Primary_research_field),ylab="Frequency Research field",las=2)
table(data$Primary_research_field)

plot(table(data$country_residence),ylab="Frequency Residence",cex.axis = .35,las=2)
plot(table(data$country_origin),ylab="Frequency Origin",cex.axis = .35,las=2)

sort(table(data$country_residence),decreasing = TRUE)
sort(table(data$country_origin),decreasing = TRUE)

par(mfrow = c(1,1) ,mar=c(4,4,1,2))

summary(data$research_experience_1)
hist(data$research_experience_1,ylab="",main="Years of research experience", breaks = 50)

hist(data$gender, main="Gender distribution", xaxt="n", xlab="")
axis(1, at=c(1,2,3), labels=c("Female","Male", "Other")) 

par(mfrow = c(1,1) ,mar=c(7,4,1,2))
hist(data$climate_worry, main="Climate Concern",  breaks=c(0,1,2,3,4,5,6,7,8,9), xaxt="n", xlab="")
axis(1, at=c(.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5), labels=c("Not at all","","A bit","","Somewhat","","Very","","Extremely much"),las=2)

par(mfrow = c(1,1) ,mar=c(14,4,1,2))
hist(data$politics, main=" Political view",  breaks=c(0,1,2,3,4,5,6,7,8,9,10,11), xaxt="n", xlab="")
axis(1, at=c(.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,10.5), labels=c("1 left-wing","2","3","4","5","6","7","8","9","10 right-wing","Don't know/ prefer not to answer"),las=2)

data_clust<-data[-c(which(is.na(data[,86])),which(is.na(data[,87])),which(is.na(data[,88]))),c(1,86:88)]
#elbow method to decide how many clusters we need
set.seed(0123)
inter <- c()
for (i in 1:10) {
  inter <- c(inter, kmeans(data_clust[,2:4],i)$tot.withinss)
  
}
plot(1:i, inter, type = "b")
(inter / inter[1]) %>% diff(1) * 100
lines(c(2,10), inter[c(2,10)], col = "blue")
lines(c(3,10), inter[c(3,10)], col = "blue")
lines(c(4,10), inter[c(4,10)], col = "blue")
lines(c(5,10), inter[c(5,10)], col = "blue")
lines(c(6,10), inter[c(6,10)], col = "blue")
lines(c(7,10), inter[c(7,10)], col = "blue")
lines(c(8,10), inter[c(8,10)], col = "blue")
lines(c(9,10), inter[c(9,10)], col = "blue")

#seems like we have elbow at 2, but more interested in 4 clusters

kmeans <- kmeans(data_clust[2:4], 3)
centers <- kmeans$centers
centers

table(kmeans$cluster) # more or less equally distributed 

data_clust$cluster <- kmeans$cluster

par(mfrow = c(1, 1) ,mar=c(2,2,2,2))

data_clust_long<-reshape(data_clust, direction = "long", varying = names(data_clust)[2:4], idvar = "Response.ID", sep="_",timevar="Question")




###-----------Hierarchical clustering-----------------------------
sum(is.na(data_clust))
#str(data_clust[1:100,1:16])


clust_dist <- dist(data_clust[,2:4], method='euclidian')
hier_clust <- hclust(clust_dist, method='complete')

library(stats)
dist_dend <- as.dendrogram(hier_clust)
plot(dist_dend) 
dend_col <- color_branches(dist_dend, k=3)
plot(dend_col)

groups <- cutree(hier_clust, h = 9)

table(groups)
data_clust_long$hgroups <- groups




library(poLCA)
#?poLCA

colnames(data_clust)<-c("ID","GEM_LifeSatisfaction","GEM_DevelopmentSpace","GEM_EnvironmentalProtection")
f<-with(data_clust, cbind(GEM_LifeSatisfaction,GEM_DevelopmentSpace,GEM_EnvironmentalProtection)~1) 

set.seed(01012)
lc1 <- poLCA(f, maxiter=1000, nclass=1, nrep=10, data=data_clust, verbose=FALSE)
lc2 <- poLCA(f, maxiter=1000, nclass=2, nrep=10, data=data_clust, verbose=FALSE)
lc3 <- poLCA(f, maxiter=1000, nclass=3, nrep=10, data=data_clust, verbose=FALSE)
lc4 <- poLCA(f, maxiter=1000, nclass=4, nrep=10, data=data_clust, verbose=FALSE)
lc5 <- poLCA(f, maxiter=1000, nclass=5, nrep=10, data=data_clust, verbose=FALSE)
lc6 <- poLCA(f, maxiter=1000, nclass=6, nrep=10, data=data_clust, verbose=FALSE)
lc7 <- poLCA(f, maxiter=1000, nclass=7, nrep=10, data=data_clust, verbose=FALSE)
lc8 <- poLCA(f, maxiter=1000, nclass=8, nrep=10, data=data_clust, verbose=FALSE)
lc9 <- poLCA(f, maxiter=1000, nclass=9, nrep=10, data=data_clust, verbose=FALSE)

# generate dataframe with fit-values

results <- data.frame(Modell=c("Modell 1"),
                      log_likelihood=lc1$llik,
                      df = lc1$resid.df,
                      BIC=lc1$bic,
                      ABIC=  (-2*lc1$llik) + ((log((lc1$N + 2)/24)) * lc1$npar),
                      CAIC = (-2*lc1$llik) + lc1$npar * (1 + log(lc1$N)), 
                      likelihood_ratio=lc1$Gsq)
results$Modell<-as.integer(results$Modell)
results[1,1]<-c("1 cluster")
results[2,1]<-c("2 clusters")
results[3,1]<-c("3 clusters")
results[4,1]<-c("4 clusters")
results[5,1]<-c("5 clusters")
results[6,1]<-c("6 clusters")
results[7,1]<-c("7 clusters")
results[8,1]<-c("8 clusters")
results[9,1]<-c("9 clusters")

results[2,2]<-lc2$llik
results[3,2]<-lc3$llik
results[4,2]<-lc4$llik
results[5,2]<-lc5$llik
results[6,2]<-lc6$llik
results[7,2]<-lc7$llik
results[8,2]<-lc8$llik
results[9,2]<-lc9$llik

results[2,3]<-lc2$resid.df
results[3,3]<-lc3$resid.df
results[4,3]<-lc4$resid.df
results[5,3]<-lc5$resid.df
results[6,3]<-lc6$resid.df
results[7,3]<-lc7$resid.df
results[8,3]<-lc8$resid.df
results[9,3]<-lc9$resid.df

results[2,4]<-lc2$bic
results[3,4]<-lc3$bic
results[4,4]<-lc4$bic
results[5,4]<-lc5$bic
results[6,4]<-lc6$bic
results[7,4]<-lc7$bic
results[8,4]<-lc8$bic
results[9,4]<-lc9$bic

results[2,5]<-(-2*lc2$llik) + ((log((lc2$N + 2)/24)) * lc2$npar) #abic
results[3,5]<-(-2*lc3$llik) + ((log((lc3$N + 2)/24)) * lc3$npar)
results[4,5]<-(-2*lc4$llik) + ((log((lc4$N + 2)/24)) * lc4$npar)
results[5,5]<-(-2*lc5$llik) + ((log((lc5$N + 2)/24)) * lc5$npar)
results[6,5]<-(-2*lc6$llik) + ((log((lc6$N + 2)/24)) * lc6$npar)
results[7,5]<-(-2*lc7$llik) + ((log((lc7$N + 2)/24)) * lc7$npar) 
results[8,5]<-(-2*lc8$llik) + ((log((lc8$N + 2)/24)) * lc8$npar) 
results[9,5]<-(-2*lc9$llik) + ((log((lc9$N + 2)/24)) * lc9$npar) 

results[2,6]<- (-2*lc2$llik) + lc2$npar * (1 + log(lc2$N)) #caic
results[3,6]<- (-2*lc3$llik) + lc3$npar * (1 + log(lc3$N))
results[4,6]<- (-2*lc4$llik) + lc4$npar * (1 + log(lc4$N))
results[5,6]<- (-2*lc5$llik) + lc5$npar * (1 + log(lc5$N))
results[6,6]<- (-2*lc6$llik) + lc6$npar * (1 + log(lc6$N))
results[7,6]<- (-2*lc7$llik) + lc7$npar * (1 + log(lc7$N))
results[8,6]<- (-2*lc8$llik) + lc8$npar * (1 + log(lc8$N))
results[9,6]<- (-2*lc9$llik) + lc9$npar * (1 + log(lc9$N))

results[2,7]<-lc2$Gsq
results[3,7]<-lc3$Gsq
results[4,7]<-lc4$Gsq
results[5,7]<-lc5$Gsq
results[6,7]<-lc6$Gsq
results[7,7]<-lc7$Gsq
results[8,7]<-lc8$Gsq
results[9,7]<-lc9$Gsq


entropy<-function (p) sum(-p*log(p))

results$R2_entropy
results[1,8]<-c("-")

error_prior<-entropy(lc2$P) # class proportions model 2
error_post<-mean(apply(lc2$posterior,1, entropy),na.rm = TRUE)
results[2,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc3$P) # class proportions model 3
error_post<-mean(apply(lc3$posterior,1, entropy),na.rm = TRUE)
results[3,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc4$P) # class proportions model 4
error_post<-mean(apply(lc4$posterior,1, entropy),na.rm = TRUE)
results[4,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc5$P) # class proportions model 5
error_post<-mean(apply(lc5$posterior,1, entropy),na.rm = TRUE)
results[5,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc6$P) # class proportions model 6
error_post<-mean(apply(lc6$posterior,1, entropy),na.rm = TRUE)
results[6,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc7$P) # class proportions model 6
error_post<-mean(apply(lc7$posterior,1, entropy),na.rm = TRUE)
results[7,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc8$P) # class proportions model 6
error_post<-mean(apply(lc8$posterior,1, entropy),na.rm = TRUE)
results[8,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc9$P) # class proportions model 6
error_post<-mean(apply(lc9$posterior,1, entropy),na.rm = TRUE)
results[9,8]<-round(((error_prior-error_post) / error_prior),3)

# combining results to a dataframe
colnames(results)<-c("Model","log-likelihood","resid. df","BIC","aBIC","cAIC","likelihood-ratio","Entropy")
lca_results<-results

#results





# ELBOW DIAGRAM

# Order categories of results$model in order of appearance
#install.packages("forcats")
library("forcats")
#results$model < - as_factor(results$model) 

#convert to long format
results2<-tidyr::gather(results,Kriterium,Guete,4:6)
#results2

#plot 
fit.plot<-ggplot(results2) + 
  geom_point(aes(x=Model,y=Guete),size=3) +
  geom_line(aes(Model, Guete, group = 1)) +
  theme_bw()+
  labs(x = "", y="", title = "") + 
  facet_grid(Kriterium ~. ,scales = "free") +
  theme_bw(base_size = 16, base_family = "") +   
  theme(panel.grid.major.x = element_blank() ,
        panel.grid.major.y = element_line(colour="grey", size=0.5),
        legend.title = element_text(size = 16, face = 'bold'),
        axis.text = element_text(size = 12),
        axis.text.x = element_text(size = 12, angle = 45, hjust = 1),
        axis.title = element_text(size = 16),
        legend.text=  element_text(size=16),
        axis.line = element_line(colour = "black")) # Achsen etwas dicker

# save 650 x 800
fit.plot




#Assume that we stick to x classes, show their size
round(colMeans(lc3$posterior)*100,2)
index_i<-apply(lc3$posterior, 1, which.max)# find for each id, the  identified class

#index_i[index_i==1]<-5
#table(index_i)
data_clust$class_LCA<-index_i

data_clust$class_LCA[index_i==1]<-2
data_clust$class_LCA[index_i==2]<-1
data_clust$class_LCA[index_i==3]<-3
#data_clust$class_LCA[index_i==4]<-"cluster4PubSur"
table(index_i)


data_clust_long<-reshape(data_clust, direction = "long", varying = names(data_clust)[2:4], idvar = "Response.ID", sep="_",timevar="Question")
#plotting responses with respect to resulted clustering
p <- ggplot(data = data_clust_long, aes(x=Question, y=GEM)) + 
  geom_boxplot(aes(fill=as.factor(class_LCA)))  
p + facet_wrap( ~ Question, scales="free")+  
  scale_fill_manual(values=c("limegreen","cyan","magenta"),  name="", breaks=c("1","2","3"),
                    labels=c("Green growth", "Agrowth","Degrowth"))+ 
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        legend.position="bottom")


data$GEMcluster<-matrix(NA,length(data$STATUS),1)

  
  data$GEMcluster[data$CID %in% data_clust$ID]<-data_clust$class_LCA[data_clust$ID %in% data$CID]
  summary(data$GEMcluster)

data$GEMcluster<-as.factor(data$GEMcluster)

m_change <- polr(GEMcluster ~   Primary_research_field+1 
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
library("forcats")
library(DescTools)
PseudoR2(m_change,which="Nagelkerke")

data$GEMcluster<-as.numeric(data$GEMcluster)
m_change <- lm(GEMcluster ~   Primary_research_field 
                 , data = data)
summary(m_change)

DataCorrplot<-data[,c(6,20:23,60:65,85,89,90,96,102)]
colnames(DataCorrplot)<-c( "LENGTH OF INTERVIEW","importance of effectiveness" ,"importance of efficiency","importance of equity","importance of feasibility","importance of direct regulation",   "importance of carbon tax","importance of cap and trade", "importance of adoption subsidies","importance of innovation support","importance of info provision", "climate_worry","research_experience_1","gender","politics","GEMcluster")
library(tidyverse)

DataCorrplot<-drop_na(DataCorrplot)

par(mfrow = c(1, 1) ,mar=c(1,1,1,2))
M <- cor(DataCorrplot)

corrplot(M, method = "circle",tl.cex=.9,tl.col = "black",col=colorRampPalette(c("blue","white","red"))(200))

```


It is interesting that Green Growth views are much more concentrated in China, Greece and Nigeria, while almost absent in Sweden and Spain

Political Scientists are concentrated on Agrowth, Eco economists and psychology are more in degrowth

In other words, the richer is the country the scientist is residing in or originates from, the more likely he is of Degrowth opinion. Worth mentioning that the country of origin is considerably more important than the residence.

```{r, echo=FALSE}

cor.test(data$GEMcluster,data$countryresGDPpc)
#plot(data$countryresGDPpc,data$GEMcluster,xlab="GDP per capita in residence country ",ylab="View on growth vs env")


cor.test(data$GEMcluster,data$countryoriGDPpc)
#plot(data$countryresGDPpc,data$GEMcluster,xlab="GDP per capita in origin country ",ylab="View on growth vs env")

library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
ggplot(data, aes(x=countryoriGDPpc, y=GEMcluster) )+ geom_point()  +
  stat_density_2d(aes(fill = ..level..), geom = "polygon")+   
  scale_fill_distiller(palette=1, direction=1) +
  geom_smooth(method = "lm", se = FALSE,colour="red")+ 
  #ylim(0,250)+
  #scale_alpha_continuous(limits=c(0.001,0.02))+ 
  scale_alpha_continuous(limits=c(0.001,0.02))+ labs(fill = "density", title="",
                                                     xlab="GDP per capita in origin country",ylab="View on growth vs env")

linearMod <- lm(GEMcluster ~ countryresGDPpc + countryoriGDPpc, data=data)
summary(linearMod)

linearMod <- lm(GEMcluster ~ log(countryresGDPpc) +log(countryoriGDPpc), data=data)
summary(linearMod)

residence_GreenGrowth<-data$country_residence[which(data$GEMcluster==1)]
residence_AGrowth<-data$country_residence[which(data$GEMcluster==2)]
residence_DeGrowth<-data$country_residence[which(data$GEMcluster==3)]
sort(table(residence_GreenGrowth),decreasing = TRUE)
sort(table(residence_AGrowth),decreasing = TRUE)
sort(table(residence_DeGrowth),decreasing = TRUE)

pie(table(residence_GreenGrowth),main="Residence of GreenGrowth researchers")
pie(table(residence_AGrowth),main="Residence of AGrowth researchers")
pie(table(residence_DeGrowth),main="Residence of DeGrowth researchers")


discipline_GreenGrowth<-data$Primary_research_field[which(data$GEMcluster==1)]
discipline_AGrowth<-data$Primary_research_field[which(data$GEMcluster==2)]
discipline_DeGrowth<-data$Primary_research_field[which(data$GEMcluster==3)]
sort(table(discipline_GreenGrowth),decreasing = TRUE)
sort(table(discipline_AGrowth),decreasing = TRUE)
sort(table(discipline_DeGrowth),decreasing = TRUE)

pie(table(discipline_GreenGrowth),main="Discipline of GreenGrowth researchers")
pie(table(discipline_AGrowth),main="Discipline of AGrowth researchers")
pie(table(discipline_DeGrowth),main="Discipline of DeGrowth researchers")

```
heat map of country of residence
```{r, echo=FALSE}


defaultW <- getOption("warn")
options(warn = -1)

#table(data_clean$Dochead)
table(data$country_residence)
library(rworldmap)
library(RColorBrewer)
dF<-matrix(0,74,2)
dF<-as.data.frame(dF)
names(dF)<-c("country", "value")
dF$country<-names(table(data$country_residence))
dF$value<-as.numeric(table(data$country_residence))

suppressPackageStartupMessages(library(sf))
world <- st_as_sf(rnaturalearth::countries110)
world <- world[world$name != 'Antarctica',]

world.clipped <- world
#suppressWarnings(st_intersection(africa, st_sfc(africa.bbox, crs=st_crs(africa))))
world.clipped<-world.clipped[order(world.clipped$sovereignt),]
#world.clipped$sovereignt
dF$country[dF$country=="United States"]<-"United States of America"

library(dplyr)
mydata_merged<-left_join(world.clipped,dF,by = c("sovereignt" = "country"))


library(ggplot2)
# attach(mtcars)
# par(mfrow=c(2,2))
plot_coins<-ggplot(mydata_merged, aes(fill=value)) +
  geom_sf(alpha=0.8,col='white') +
  #coord_sf(crs="+proj=aea +lat_1=+36.333333333333336 +lat_2=65.66666666666667 +lon_0=14") +
  hrbrthemes::theme_ipsum_rc() +
  viridis::scale_fill_viridis(
    name='', direction = -1, labels=scales::number) +
  labs(x=NULL, y=NULL, title='World')
plot_coins


europe <- world[world$region_un=="Europe"&world$name!='Russia'&world$name!='Ukraine',]
# plot(europe)

# A bounding box for continental Europe.
europe.bbox <- st_polygon(list(
  matrix(c(-25,29,45,29,45,75,-25,75,-25,29),byrow = T,ncol = 2)))

# Get polygons that are only in continental Europe.
europe.clipped <-suppressWarnings(st_intersection(europe, st_sfc(europe.bbox, crs=st_crs(europe))))
europe_merged<-left_join(europe.clipped,dF,by = c("sovereignt" = "country"))



plot_europe<-ggplot(europe_merged, aes(fill=value)) +
  geom_sf(alpha=0.8,col='white') +
  #coord_sf(crs="+proj=aea +lat_1=+36.333333333333336 +lat_2=65.66666666666667 +lon_0=14") +
  hrbrthemes::theme_ipsum_rc() +
  viridis::scale_fill_viridis(
    name='', direction = -1, labels=scales::number) +
  labs(x=NULL, y=NULL, title='Europe')
plot_europe
library(ggpubr)
ggarrange(plot_coins, plot_europe, 
          # labels = c("A", "B"),
          ncol = 2, nrow = 1)

options(warn = defaultW)
```
heat map of country of origin
```{r, echo=FALSE}


defaultW <- getOption("warn")
options(warn = -1)

#table(data_clean$Dochead)
table(data$country_origin)
library(rworldmap)
library(RColorBrewer)
dF<-matrix(0,79,2)
dF<-as.data.frame(dF)
names(dF)<-c("country", "value")
dF$country<-names(table(data$country_origin))
dF$value<-as.numeric(table(data$country_origin))

suppressPackageStartupMessages(library(sf))
world <- st_as_sf(rnaturalearth::countries110)
world <- world[world$name != 'Antarctica',]

# A bounding box for continental Europe.
#africa.bbox <- st_polygon(list(
#  matrix(c(-25,79,75,29,45,-75,-25,-75,-25,79),byrow = T,ncol = 2)))

world.clipped <- world
#suppressWarnings(st_intersection(africa, st_sfc(africa.bbox, crs=st_crs(africa))))
world.clipped<-world.clipped[order(world.clipped$sovereignt),]
#world.clipped$sovereignt
dF$country[dF$country=="United States"]<-"United States of America"

library(dplyr)
mydata_merged<-left_join(world.clipped,dF,by = c("sovereignt" = "country"))


library(ggplot2)
# attach(mtcars)
# par(mfrow=c(2,2))
plot_coins<-ggplot(mydata_merged, aes(fill=value)) +
  geom_sf(alpha=0.8,col='white') +
  #coord_sf(crs="+proj=aea +lat_1=+36.333333333333336 +lat_2=65.66666666666667 +lon_0=14") +
  hrbrthemes::theme_ipsum_rc() +
  viridis::scale_fill_viridis(
    name='', direction = -1, labels=scales::number) +
  labs(x=NULL, y=NULL, title='World')
plot_coins


europe <- world[world$region_un=="Europe"&world$name!='Russia'&world$name!='Ukraine',]
# plot(europe)

# A bounding box for continental Europe.
europe.bbox <- st_polygon(list(
  matrix(c(-25,29,45,29,45,75,-25,75,-25,29),byrow = T,ncol = 2)))

# Get polygons that are only in continental Europe.
europe.clipped <-suppressWarnings(st_intersection(europe, st_sfc(europe.bbox, crs=st_crs(europe))))
europe_merged<-left_join(europe.clipped,dF,by = c("sovereignt" = "country"))



plot_europe<-ggplot(europe_merged, aes(fill=value)) +
  geom_sf(alpha=0.8,col='white') +
  #coord_sf(crs="+proj=aea +lat_1=+36.333333333333336 +lat_2=65.66666666666667 +lon_0=14") +
  hrbrthemes::theme_ipsum_rc() +
  viridis::scale_fill_viridis(
    name='', direction = -1, labels=scales::number) +
  labs(x=NULL, y=NULL, title='Europe')
plot_europe
library(ggpubr)
ggarrange(plot_coins, plot_europe, 
          # labels = c("A", "B"),
          ncol = 2, nrow = 1)

options(warn = defaultW)
```

Here I just look on the keywords given at the beginning of the survey to see what kewords are more common. This is not topic modelling but merely keyword analysis by most frequent combinations.

```{r, echo=FALSE}
library(textstem)
library(stringr)
title_lemm <- lemmatize_strings(data$Research_interests_1)
head(title_lemm)
# head(abstract_stem)
title_lemm2<-unlist(strsplit(title_lemm, ","))
title_lemm3<-str_trim(title_lemm2, side = "both") 
title_lemm4 <- gsub(" ", "_", title_lemm3)

library(stm)
processed <- textProcessor(title_lemm4,
                           metadata = matrix(0,2,2088), lowercase = TRUE,
                           removestopwords = FALSE, removenumbers = FALSE,
                           removepunctuation = FALSE, stem = FALSE,
                           wordLengths = c(2, Inf), sparselevel = 1,  language = "en",
                           verbose = TRUE)

out <- prepDocuments(processed$documents, processed$vocab, meta=processed$meta, lower.thresh=3,verbose = TRUE)


vocab_app<-out$vocab
junk<-out$wordcounts[out$wordcounts>3]
freq_vocab<-out$wordcounts[out$wordcounts>3]
#table(unlist(out$documents))
vocab_app<-vocab_app[order(freq_vocab,decreasing = TRUE)]
pop_words<-cbind(vocab_app,freq_vocab[order(freq_vocab,decreasing = TRUE)])
print(length(out$vocab))


#100 most popular words in the whole text
print(pop_words[1:100])
write.csv(pop_words,"pop_word.csv",fileEncoding = "ISO-8859-1")

demoFreq<-as.data.frame(pop_words)
library(wordcloud2)
colnames(demoFreq)<-c("word","freq")
demoFreq$freq<-as.numeric(demoFreq$freq)
wordcloud(words=demoFreq$word,freq=demoFreq$freq, rot.per = .1)
#wordcloud2(data = demoFreq)




```

 Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    1.0    34.0    59.0    75.2    96.0  1464.0  


Plots comparing importance of different criteria across disciplines for climate policy evaluation.

Effectiveness is by far the most important criterion while Efficiency the least impotrnat one. Nevertheless, there is considerable discrepancy across the disciplines
```{r, echo=FALSE}
defaultW <- getOption("warn")
options(warn = -1)

data_long<-reshape(data[,c(1,16,20:23)], direction = "long", varying = names(data)[c(20:23)], idvar = "Response.ID", sep="_",timevar="Question")


data_long[,3]<-as.character(data_long[,3])
names(data_long)<-c("Response.ID","Discipline","Criterion","Value", "ID")

myData <- aggregate(data_long$Value,
                    by = list(data_long$Criterion),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Criterion", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Criterion[myData$Criterion=="1"]<-"Effectiveness"
myData$Criterion[myData$Criterion=="2"]<-"Efficiency"
myData$Criterion[myData$Criterion=="3"]<-"Equity"
myData$Criterion[myData$Criterion=="4"]<-"Feasibility"


ggplot(data = myData, aes(x = Criterion, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Criterion", y = "")+
  scale_y_continuous(breaks = 1:5, labels = c("Unimportant","Somewhat important","Important","Very important","Extremely important"),limits=c(2.3,5.2))+
  #ylim(2.3, 5.2)+
  geom_point( position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))






par(mfrow = c(1,1))
library(conover.test)
sig_level_1<-0.01
sig_level_2<-0.05
sig_level_3<-0.10
data_selected<-data[,c(20:23)]
Sig_matrix_Effectiveness<-matrix(0,4,4)
Sig_matrix_Effectiveness_p<-matrix(1,4,4)
for (i in 1:4){
  for (j in 1:4){
w_test<-wilcox.test(data_selected[,i], data_selected[,j], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_Effectiveness[i,j]<-3
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_Effectiveness[i,j]<-2
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_Effectiveness[i,j]<-1
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value

  }
}
colnames(Sig_matrix_Effectiveness)<-c('Effectiveness','Efficiency','Equity','Feasibility')
rownames(Sig_matrix_Effectiveness)<-c('Effectiveness','Efficiency','Equity','Feasibility')
colnames(Sig_matrix_Effectiveness_p)<-c('Effectiveness','Efficiency','Equity','Feasibility')
rownames(Sig_matrix_Effectiveness_p)<-c('Effectiveness','Efficiency','Equity','Feasibility')
corrplot(Sig_matrix_Effectiveness, 
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_Effectiveness_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,
         insig = "label_sig", pch.col = "white")





data_long<-data[,c(1,16,20)]
names(data_long)<-c("Response.ID","Discipline","Effectiveness")

myData <- aggregate(data_long$Effectiveness,
                    by = list(data_long$Discipline),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline", "mean", "sd", "n", "se")


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Effectiveness")+
  scale_y_continuous(breaks = 1:5, labels = c("Unimportant","Somewhat important","Important","Very important","Extremely important"),limits=c(2.3,5.2))+
  #ylim(2.3, 5.2)+
  geom_point(, position = position_dodge(0.5)) +
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

CoV_Effectiveness<-sd(myData[,2])/mean(myData[,2],na.rm=TRUE)


par(mfrow = c(1,1))
library(conover.test)
sig_level_1<-0.01
sig_level_2<-0.05
sig_level_3<-0.10
discipline_list<-c("Agri./forestry","Ecol. economics","Engineering","Env. economics","Geography","Ind. ecology","Law","Math & comp. sci.","Natural sci.","Oth. env. soc. sci.","Oth. economics","Political sci.","Psychology","Sociology","Sust. transition")



data_selected<-data[,c(20)]
Sig_matrix_Effectiveness<-matrix(0,15,15)
Sig_matrix_Effectiveness_p<-matrix(1,15,15)
for (i in 1:15){
  for (j in 1:15){
w_test<-wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_Effectiveness[i,j]<-3
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_Effectiveness[i,j]<-2
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_Effectiveness[i,j]<-1
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
}
colnames(Sig_matrix_Effectiveness)<-discipline_list
rownames(Sig_matrix_Effectiveness)<-discipline_list
colnames(Sig_matrix_Effectiveness_p)<-discipline_list
rownames(Sig_matrix_Effectiveness_p)<-discipline_list
corrplot(Sig_matrix_Effectiveness, 
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_Effectiveness_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,
         insig = "label_sig", pch.col = "white")


data_long<-data[,c(1,16,21)]
names(data_long)<-c("Response.ID","Discipline","Effieciency")

myData <- aggregate(data_long$Effieciency,
                    by = list(data_long$Discipline),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline", "mean", "sd", "n", "se")


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Effieciency")+
  scale_y_continuous(breaks = 1:5, labels = c("Unimportant","Somewhat important","Important","Very important","Extremely important"),limits=c(2.3,5.2))+
  #ylim(2.3, 5.2)+
  geom_point(, position = position_dodge(0.5)) +
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

CoV_Efficiency<-sd(myData[,2])/mean(myData[,2],na.rm=TRUE)


data_selected<-data[,c(21)]
Sig_matrix_Effectiveness<-matrix(0,15,15)
Sig_matrix_Effectiveness_p<-matrix(1,15,15)
for (i in 1:15){
  for (j in 1:15){
w_test<-wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_Effectiveness[i,j]<-3
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_Effectiveness[i,j]<-2
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_Effectiveness[i,j]<-1
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
}
colnames(Sig_matrix_Effectiveness)<-discipline_list
rownames(Sig_matrix_Effectiveness)<-discipline_list
colnames(Sig_matrix_Effectiveness_p)<-discipline_list
rownames(Sig_matrix_Effectiveness_p)<-discipline_list
corrplot(Sig_matrix_Effectiveness, 
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_Effectiveness_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,
         insig = "label_sig", pch.col = "white")



data_long<-data[,c(1,16,22)]
names(data_long)<-c("Response.ID","Discipline","Equity")

myData <- aggregate(data_long$Equity,
                    by = list(data_long$Discipline),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline", "mean", "sd", "n", "se")


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Equity")+
  scale_y_continuous(breaks = 1:5, labels = c("Unimportant","Somewhat important","Important","Very important","Extremely important"),limits=c(2.3,5.2))+
  #ylim(2.3, 5.2)+
  geom_point(, position = position_dodge(0.5)) +
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

CoV_Equity<-sd(myData[,2])/mean(myData[,2],na.rm=TRUE)

data_selected<-data[,c(22)]
Sig_matrix_Effectiveness<-matrix(0,15,15)
Sig_matrix_Effectiveness_p<-matrix(1,15,15)
for (i in 1:15){
  for (j in 1:15){
w_test<-wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_Effectiveness[i,j]<-3
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_Effectiveness[i,j]<-2
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_Effectiveness[i,j]<-1
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
}
colnames(Sig_matrix_Effectiveness)<-discipline_list
rownames(Sig_matrix_Effectiveness)<-discipline_list
colnames(Sig_matrix_Effectiveness_p)<-discipline_list
rownames(Sig_matrix_Effectiveness_p)<-discipline_list
corrplot(Sig_matrix_Effectiveness, 
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_Effectiveness_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,
         insig = "label_sig", pch.col = "white")



data_long<-data[,c(1,16,23)]
names(data_long)<-c("Response.ID","Discipline","Feasibility")

myData <- aggregate(data_long$Feasibility,
                    by = list(data_long$Discipline),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline", "mean", "sd", "n", "se")


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Feasibility")+
  #ylim(2.3, 5.2)+
  scale_y_continuous(breaks = 1:5, labels = c("Unimportant","Somewhat important","Important","Very important","Extremely important"),limits=c(2.3,5.2))+ 
geom_point(, position = position_dodge(0.5)) +
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))
  
CoV_Feasibility<-sd(myData[,2])/mean(myData[,2],na.rm=TRUE)

data_selected<-data[,c(23)]
Sig_matrix_Effectiveness<-matrix(0,15,15)
Sig_matrix_Effectiveness_p<-matrix(1,15,15)
for (i in 1:15){
  for (j in 1:15){
w_test<-wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_Effectiveness[i,j]<-3
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_Effectiveness[i,j]<-2
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_Effectiveness[i,j]<-1
Sig_matrix_Effectiveness_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
}
colnames(Sig_matrix_Effectiveness)<-discipline_list
rownames(Sig_matrix_Effectiveness)<-discipline_list
colnames(Sig_matrix_Effectiveness_p)<-discipline_list
rownames(Sig_matrix_Effectiveness_p)<-discipline_list
corrplot(Sig_matrix_Effectiveness, 
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_Effectiveness_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,
         insig = "label_sig", pch.col = "white")




```

Plots comparing 6 different instruments across 4 criteria and all disciplines.
First plot all disciplines together and then distinguishing them


```{r, echo=FALSE}

data_long<-reshape(data[,c(1,16,27:32)], direction = "long", varying = names(data)[c(27:32)], idvar = "Response.ID", sep="_",timevar="Question")

# data_long<-reshape(data[,c(1,16,27:33,35:41,43:49,50:57)], direction = "long", varying = names(data)[c(27:33,35:41,43:49,50:57)], idvar = "Response.ID", sep="_",timevar="Question")


data_long[,3]<-as.character(data_long[,3])
names(data_long)<-c("Response.ID","Discipline","Instrument","Effectiveness", "ID")



myData <- aggregate(data_long$Effectiveness,
                    by = list(data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"

ggplot(data = myData, aes(x = Instrument, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Instrument", y = "Effectiveness")+
    scale_color_manual(values=c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00", "#FFFF33"))+
geom_point( position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
   ylim(1.0, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))






myData <- aggregate(data_long$Effectiveness,
                    by = list(data_long$Discipline,data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline","Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Instrument),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Effectiveness")+
    scale_color_manual(values=c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00", "#FFFF33"))+
geom_point(aes(color = Instrument), position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
  ylim(1.0, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p1<-ggplot(data = myData[which(myData$Instrument=="Adoption subsidies"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Adoption subsidies",x = "", y = "Effectiveness")+
geom_point(position = position_dodge(0.1)) +
  ylim(1.0, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p2<-ggplot(data = myData[which(myData$Instrument=="Cap-and-trade"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Cap-and-trade",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
  ylim(1.0, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p3<-ggplot(data = myData[which(myData$Instrument=="Carbon tax"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Carbon tax",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
  ylim(1.0, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p4<-ggplot(data = myData[which(myData$Instrument=="Direct regulation"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Direct regulation",x = "", y = "Effectiveness")+
geom_point(position = position_dodge(0.1)) +
  ylim(1.0, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p5<-ggplot(data = myData[which(myData$Instrument=="Information provision"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Information provision",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
  ylim(1.0, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p6<-ggplot(data = myData[which(myData$Instrument=="Innovation support"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Innovation support",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
  ylim(1.0, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))


grid.arrange(p1, p2, p3, p4,p5,p6, nrow = 2)






data_long<-reshape(data[,c(1,16,35:40)], direction = "long", varying = names(data)[c(35:40)], idvar = "Response.ID", sep="_",timevar="Question")

# data_long<-reshape(data[,c(1,16,27:33,35:41,43:49,50:57)], direction = "long", varying = names(data)[c(27:33,35:41,43:49,50:57)], idvar = "Response.ID", sep="_",timevar="Question")


data_long[,3]<-as.character(data_long[,3])
names(data_long)<-c("Response.ID","Discipline","Instrument","Efficiency", "ID")



myData <- aggregate(data_long$Efficiency,
                    by = list(data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"

ggplot(data = myData, aes(x = Instrument, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Instrument", y = "Efficiency")+
    scale_color_manual(values=c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00", "#FFFF33"))+
geom_point( position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))


myData <- aggregate(data_long$Efficiency,
                    by = list(data_long$Discipline,data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline","Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Instrument),
                position= position_dodge(0.5), width = 0.2) +
    scale_color_manual(values=c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00", "#FFFF33"))+
labs(x = "Discipline", y = "Efficiency")+
  geom_point(aes(color = Instrument), position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))


p1<-ggplot(data = myData[which(myData$Instrument=="Adoption subsidies"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Adoption subsidies",x = "", y = "Efficiency")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p2<-ggplot(data = myData[which(myData$Instrument=="Cap-and-trade"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Cap-and-trade",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p3<-ggplot(data = myData[which(myData$Instrument=="Carbon tax"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Carbon tax",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p4<-ggplot(data = myData[which(myData$Instrument=="Direct regulation"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Direct regulation",x = "", y = "Efficiency")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p5<-ggplot(data = myData[which(myData$Instrument=="Information provision"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Information provision",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p6<-ggplot(data = myData[which(myData$Instrument=="Innovation support"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Innovation support",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))


grid.arrange(p1, p2, p3, p4,p5,p6, nrow = 2)







data_long<-reshape(data[,c(1,16,43:48)], direction = "long", varying = names(data)[c(43:48)], idvar = "Response.ID", sep="_",timevar="Question")

# data_long<-reshape(data[,c(1,16,27:33,35:41,43:49,50:57)], direction = "long", varying = names(data)[c(27:33,35:41,43:49,50:57)], idvar = "Response.ID", sep="_",timevar="Question")


data_long[,3]<-as.character(data_long[,3])
names(data_long)<-c("Response.ID","Discipline","Instrument","Equity", "ID")


myData <- aggregate(data_long$Equity,
                    by = list(data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"

ggplot(data = myData, aes(x = Instrument, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
    scale_color_manual(values=c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00", "#FFFF33"))+
labs(x = "Instrument", y = "Equity")+
  geom_point( position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))


myData <- aggregate(data_long$Equity,
                    by = list(data_long$Discipline,data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline","Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Instrument),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Equity")+
    scale_color_manual(values=c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00", "#FFFF33"))+
geom_point(aes(color = Instrument), position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))




p1<-ggplot(data = myData[which(myData$Instrument=="Adoption subsidies"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Adoption subsidies",x = "", y = "Equity")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p2<-ggplot(data = myData[which(myData$Instrument=="Cap-and-trade"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Cap-and-trade",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p3<-ggplot(data = myData[which(myData$Instrument=="Carbon tax"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Carbon tax",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p4<-ggplot(data = myData[which(myData$Instrument=="Direct regulation"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Direct regulation",x = "", y = "Equity")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p5<-ggplot(data = myData[which(myData$Instrument=="Information provision"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Information provision",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p6<-ggplot(data = myData[which(myData$Instrument=="Innovation support"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Innovation support",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))


grid.arrange(p1, p2, p3, p4,p5,p6, nrow = 2)





data_long<-reshape(data[,c(1,16,51:56)], direction = "long", varying = names(data)[c(51:56)], idvar = "Response.ID", sep="_",timevar="Question")

# data_long<-reshape(data[,c(1,16,27:33,35:41,43:49,50:57)], direction = "long", varying = names(data)[c(27:33,35:41,43:49,50:57)], idvar = "Response.ID", sep="_",timevar="Question")


data_long[,3]<-as.character(data_long[,3])
names(data_long)<-c("Response.ID","Discipline","Instrument","Feasibility", "ID")



myData <- aggregate(data_long$Feasibility,
                    by = list(data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"

ggplot(data = myData, aes(x = Instrument, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Instrument", y = "Feasibility")+
    scale_color_manual(values=c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00", "#FFFF33"))+
  geom_point( position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))



myData <- aggregate(data_long$Feasibility,
                    by = list(data_long$Discipline,data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline","Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Instrument),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Feasibility")+
  scale_color_manual(values=c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00", "#FFFF33"))+
  geom_point(aes(color = Instrument), position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p1<-ggplot(data = myData[which(myData$Instrument=="Adoption subsidies"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Adoption subsidies",x = "", y = "Feasibility")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p2<-ggplot(data = myData[which(myData$Instrument=="Cap-and-trade"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Cap-and-trade",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p3<-ggplot(data = myData[which(myData$Instrument=="Carbon tax"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Carbon tax",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p4<-ggplot(data = myData[which(myData$Instrument=="Direct regulation"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Direct regulation",x = "", y = "Feasibility")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p5<-ggplot(data = myData[which(myData$Instrument=="Information provision"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Information provision",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p6<-ggplot(data = myData[which(myData$Instrument=="Innovation support"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Innovation support",x = "", y = "")+
geom_point(position = position_dodge(0.1)) +
   ylim(1.1, 3.5)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))


grid.arrange(p1, p2, p3, p4,p5,p6, nrow = 2)

```


I added now statistical tests. The order on the last chart is exactly the same as on the previous one:
Adop Subsidies, capandtrade, carbon tax, direct regulation, info provision, inf support

```{r, echo=FALSE}
defaultW <- getOption("warn")
options(warn = -1)

data_long<-reshape(data[,c(1,16,60:65)], direction = "long", varying = names(data)[c(60:65)], idvar = "Response.ID", sep="_",timevar="Question")

# data_long<-reshape(data[,c(1,16,27:33,35:41,43:49,50:57)], direction = "long", varying = names(data)[c(27:33,35:41,43:49,50:57)], idvar = "Response.ID", sep="_",timevar="Question")


data_long[,3]<-as.character(data_long[,3])
names(data_long)<-c("Response.ID","Discipline","Instrument","Importance_Policy_Mix", "ID")




myData <- aggregate(data_long$Importance_Policy_Mix,
                    by = list(data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"


ggplot(data = myData, aes(x = Instrument, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Instrument importance")+
geom_point(position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
   ylim(2.0, 5.0)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))



data_selected<-data[,c(60:65)]
Sig_matrix_Importance_Policy_Mix<-matrix(0,6,6)
Sig_matrix_Importance_Policy_Mix_p<-matrix(1,6,6)
for (i in 1:6){
  for (j in 1:6){
w_test<-wilcox.test(data_selected[,i], data_selected[,j], paired = TRUE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_Importance_Policy_Mix[i,j]<-3
Sig_matrix_Importance_Policy_Mix_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_Importance_Policy_Mix[i,j]<-2
Sig_matrix_Importance_Policy_Mix_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_Importance_Policy_Mix[i,j]<-1
Sig_matrix_Importance_Policy_Mix_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value

  }
}
colnames(Sig_matrix_Importance_Policy_Mix)<-c('Direct regulation','Carbon tax','Cap-and-trade','Adoption subsidies','Innovation support','Information provision')
rownames(Sig_matrix_Importance_Policy_Mix)<-c('Direct regulation','Carbon tax','Cap-and-trade','Adoption subsidies','Innovation support','Information provision')
colnames(Sig_matrix_Importance_Policy_Mix_p)<-c('Direct regulation','Carbon tax','Cap-and-trade','Adoption subsidies','Innovation support','Information provision')
rownames(Sig_matrix_Importance_Policy_Mix_p)<-c('Direct regulation','Carbon tax','Cap-and-trade','Adoption subsidies','Innovation support','Information provision')
corrplot(Sig_matrix_Importance_Policy_Mix, 
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_Importance_Policy_Mix_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,
         insig = "label_sig", pch.col = "white")


myData <- aggregate(data_long$Importance_Policy_Mix,
                    by = list(data_long$Discipline,data_long$Instrument),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline","Instrument", "mean", "sd", "n", "se")
# myData$RevenueUse<-c('0','1','2','3','4','5')
# myData$InformationProvided<-as.character(myData$IInstrument)
myData$Instrument[myData$Instrument=="1"]<-"Direct regulation"
myData$Instrument[myData$Instrument=="2"]<-"Carbon tax"
myData$Instrument[myData$Instrument=="3"]<-"Cap-and-trade"
myData$Instrument[myData$Instrument=="4"]<-"Adoption subsidies"
myData$Instrument[myData$Instrument=="5"]<-"Innovation support"
myData$Instrument[myData$Instrument=="6"]<-"Information provision"


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Instrument),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Instrument importance")+
    scale_color_manual(values=c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00", "#FFFF33"))+
geom_point(aes(color = Instrument), position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
   ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))


p1<-ggplot(data = myData[which(myData$Instrument=="Adoption subsidies"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Adoption subsidies",x = "", y = "Importance_Policy_Mix")+
geom_point(position = position_dodge(0.1)) +
    ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p2<-ggplot(data = myData[which(myData$Instrument=="Cap-and-trade"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Cap-and-trade",x = "", y = "Importance_Policy_Mix")+
geom_point(position = position_dodge(0.1)) +
    ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p3<-ggplot(data = myData[which(myData$Instrument=="Carbon tax"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Carbon tax",x = "", y = "Importance_Policy_Mix")+
geom_point(position = position_dodge(0.1)) +
    ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p4<-ggplot(data = myData[which(myData$Instrument=="Direct regulation"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Direct regulation",x = "", y = "Importance_Policy_Mix")+
geom_point(position = position_dodge(0.1)) +
    ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p5<-ggplot(data = myData[which(myData$Instrument=="Information provision"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Information provision",x = "", y = "Importance_Policy_Mix")+
geom_point(position = position_dodge(0.1)) +
    ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))

p6<-ggplot(data = myData[which(myData$Instrument=="Innovation support"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se)) +
  labs(title="Innovation support",x = "", y = "Importance_Policy_Mix")+
geom_point(position = position_dodge(0.1)) +
    ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))


grid.arrange(p1, p2, p3, p4,p5,p6, nrow = 2)






palette1<-c("black", "black", "black","red", "black", "black","black", "black", "black","black", "black", "black","black", "black", "black")
p1<-ggplot(data = myData[which(myData$Instrument=="Adoption subsidies"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = palette1))+
  scale_color_manual(breaks=palette1, values=c("black", "black", "black","red", "black", "black","black", "black", "black","black", "black", "black","black", "black", "black")) + 
  labs(title="Adoption subsidies",x = "", y = "Instrument importance")+
  geom_point(position = position_dodge(0.1), color = palette1) +
  ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1))+ geom_hline(yintercept=mean(data$importantpolicies_4,na.rm=TRUE), linetype="dashed", color = "black") +
  theme(legend.position="none")

palette2<-c("black", "red", "black", "green3","black","black","black","black","black","black","red","red", "black","black","black")
p2<-ggplot(data = myData[which(myData$Instrument=="Cap-and-trade"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = palette2)) +
  scale_color_manual(breaks=palette2, values=c("black", "red", "black", "green3","black","black","black","black","black","black","green3","red", "black","black","black")) +
  labs(title="Cap-and-trade",x = "", y = "")+
  geom_point(position = position_dodge(0.1), color = palette2) +
  ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1))+ geom_hline(yintercept=mean(data$importantpolicies_3,na.rm=TRUE), linetype="dashed", color = "black") +
  theme(legend.position="none",
        axis.text.y=element_blank())


palette3<-c("black", "black", "black", "green3","black","black","black","black","black","black","black","black", "green3","black","black")
p3<-ggplot(data = myData[which(myData$Instrument=="Carbon tax"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = palette3)) +
  scale_color_manual(breaks=palette3, values=c("black", "black", "black", "green3","black","black","black","black","black","black","black","black", "green3","black","black")) +
  labs(title="Carbon tax",x = "", y = "")+
  geom_point(position = position_dodge(0.1), color = palette3) +
  ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1))+ geom_hline(yintercept=mean(data$importantpolicies_2,na.rm=TRUE), linetype="dashed", color = "black") +
  theme(legend.position="none",
        axis.text.y=element_blank())


palette4<-c("black", "black", "black", "red","black","black","black","black","black","black","green3","black", "black","black","green3")
p4<-ggplot(data = myData[which(myData$Instrument=="Direct regulation"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = palette4)) +
  scale_color_manual(breaks=palette4, values=c("black", "black", "black", "red","black","black","black","black","black","black","green3","black", "black","black","green3")) +
  labs(title="Direct regulation",x = "", y = "Instrument importance")+
  geom_point(position = position_dodge(0.1), color = palette4) +
  ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1))+ geom_hline(yintercept=mean(data$importantpolicies_1,na.rm=TRUE), linetype="dashed", color = "black") +
  theme(legend.position="none")

palette5<-c("black", "black", "black", "red","black","black","black","black","green3","black","black","black","black", "red","green3")
p5<-ggplot(data = myData[which(myData$Instrument=="Information provision"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = palette5)) +
  scale_color_manual(breaks=palette5, values=c("black", "black", "black", "red","black","black","black","black","green3","black","black","black","black", "red","green3")) +
  labs(title="Information provision",x = "", y = "")+
  geom_point(position = position_dodge(0.1), color = palette5) +
  ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1))+ geom_hline(yintercept=mean(data$importantpolicies_6,na.rm=TRUE), linetype="dashed", color = "black") +
  theme(legend.position="none",
        axis.text.y=element_blank())


palette6<-c("black", "red", "green3", "black","black","black","black","black","black","black","black","black","black", "black","black")
p6<-ggplot(data = myData[which(myData$Instrument=="Innovation support"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = palette6)) +
  scale_color_manual(breaks=palette6, values=c("black", "red", "green3", "black","black","black","black","black","black","black","black","black","black", "black","black")) +
  labs(title="Innovation support",x = "", y = "")+
  geom_point(position = position_dodge(0.1), color = palette6) +
  ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1))+ geom_hline(yintercept=mean(data$importantpolicies_5,na.rm=TRUE), linetype="dashed", color = "black") +
  theme(legend.position="none",
        axis.text.y=element_blank())


grid.arrange(p1, p2, p3, p4,p5,p6, nrow = 2)




CoV_AS<-sd(myData[which(myData$Instrument=="Adoption subsidies"),3])/mean(myData[which(myData$Instrument=="Adoption subsidies"),3],na.rm=TRUE)
CoV_CM<-sd(myData[which(myData$Instrument=="Cap-and-trade"),3])/mean(data$importantpolicies_3,na.rm=TRUE)
CoV_CT<-sd(myData[which(myData$Instrument=="Carbon tax"),3])/mean(myData[which(myData$Instrument=="Carbon tax"),3],na.rm=TRUE)
CoV_DR<-sd(myData[which(myData$Instrument=="Direct regulation"),3])/mean(myData[which(myData$Instrument=="Direct regulation"),3],na.rm=TRUE)
CoV_IP<-sd(myData[which(myData$Instrument=="Information provision"),3])/mean(myData[which(myData$Instrument=="Information provision"),3],na.rm=TRUE)
CoV_IS<-sd(myData[which(myData$Instrument=="Innovation support"),3])/mean(myData[which(myData$Instrument=="Innovation support"),3],na.rm=TRUE)


myData


data_selected<-data[,c(63)]#Adoption Subsidies
Sig_matrix_EffectivenessAsub<-matrix(0,15,16)
Sig_matrix_EffectivenessAsub_p<-matrix(1,15,16)
for (i in 1:15){
  for (j in 1:15){
w_test<-w_test<-#kruskal.test(list(data_selected[which(data$Primary_research_field==discipline_list[i])],data$importantpolicies_4),method = "bonferroni",alpha=0.01)
    wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_EffectivenessAsub[i,j]<-3
Sig_matrix_EffectivenessAsub_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_EffectivenessAsub[i,j]<-2
Sig_matrix_EffectivenessAsub_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_EffectivenessAsub[i,j]<-1
Sig_matrix_EffectivenessAsub_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
  j<-16
  w_test<-kruskal.test(list(data_selected[which(data$Primary_research_field==discipline_list[i])],data$importantpolicies_4),method = "bonferroni",alpha=0.01)
    #wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], g=data$importantpolicies_4,paired = FALSE, alternative = "two.sided")
  if (w_test$p.value<sig_level_1/2){Sig_matrix_EffectivenessAsub[i,j]<-3
  Sig_matrix_EffectivenessAsub_p[i,j]<-w_test$p.value*2}
  else if (w_test$p.value<sig_level_2/2){Sig_matrix_EffectivenessAsub[i,j]<-2
  Sig_matrix_EffectivenessAsub_p[i,j]<-w_test$p.value*2} 
  else if (w_test$p.value<sig_level_3/2){Sig_matrix_EffectivenessAsub[i,j]<-1
  Sig_matrix_EffectivenessAsub_p[i,j]<-w_test$p.value*2} 
}
colnames(Sig_matrix_EffectivenessAsub)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessAsub)<-discipline_list
colnames(Sig_matrix_EffectivenessAsub_p)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessAsub_p)<-discipline_list



data_selected<-data[,c(60)] #DirectRegulation
Sig_matrix_EffectivenessDreg<-matrix(0,15,16)
Sig_matrix_EffectivenessDreg_p<-matrix(1,15,16)
for (i in 1:15){
  for (j in 1:15){
w_test<-wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_EffectivenessDreg[i,j]<-3
Sig_matrix_EffectivenessDreg_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_EffectivenessDreg[i,j]<-2
Sig_matrix_EffectivenessDreg_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_EffectivenessDreg[i,j]<-1
Sig_matrix_EffectivenessDreg_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
  j<-16
  w_test<-kruskal.test(list(data_selected[which(data$Primary_research_field==discipline_list[i])],data$importantpolicies_1),method = "bonferroni",alpha=0.01)
    #wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], g=data$importantpolicies_1,paired = FALSE, alternative = "two.sided")
  if (w_test$p.value<sig_level_1/2){Sig_matrix_EffectivenessDreg[i,j]<-3
  Sig_matrix_EffectivenessDreg_p[i,j]<-w_test$p.value*2}
  else if (w_test$p.value<sig_level_2/2){Sig_matrix_EffectivenessDreg[i,j]<-2
  Sig_matrix_EffectivenessDreg_p[i,j]<-w_test$p.value*2} 
  else if (w_test$p.value<sig_level_3/2){Sig_matrix_EffectivenessDreg[i,j]<-1
  Sig_matrix_EffectivenessDreg_p[i,j]<-w_test$p.value*2}
}
colnames(Sig_matrix_EffectivenessDreg)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessDreg)<-discipline_list
colnames(Sig_matrix_EffectivenessDreg_p)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessDreg_p)<-discipline_list



data_selected<-data[,c(61)]#CarbonTax
Sig_matrix_EffectivenessCtax<-matrix(0,15,16)
Sig_matrix_EffectivenessCtax_p<-matrix(1,15,16)
for (i in 1:15){
  for (j in 1:15){
w_test<-wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_EffectivenessCtax[i,j]<-3
Sig_matrix_EffectivenessCtax_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_EffectivenessCtax[i,j]<-2
Sig_matrix_EffectivenessCtax_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_EffectivenessCtax[i,j]<-1
Sig_matrix_EffectivenessCtax_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
  j<-16
  w_test<-kruskal.test(list(data_selected[which(data$Primary_research_field==discipline_list[i])],data$importantpolicies_2),method = "bonferroni",alpha=0.01)
    #wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], g=data$importantpolicies_2,paired = FALSE, alternative = "two.sided")
  if (w_test$p.value<sig_level_1/2){Sig_matrix_EffectivenessCtax[i,j]<-3
  Sig_matrix_EffectivenessCtax_p[i,j]<-w_test$p.value*2}
  else if (w_test$p.value<sig_level_2/2){Sig_matrix_EffectivenessCtax[i,j]<-2
  Sig_matrix_EffectivenessCtax_p[i,j]<-w_test$p.value*2} 
  else if (w_test$p.value<sig_level_3/2){Sig_matrix_EffectivenessCtax[i,j]<-1
  Sig_matrix_EffectivenessCtax_p[i,j]<-w_test$p.value*2}
}
colnames(Sig_matrix_EffectivenessCtax)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessCtax)<-discipline_list
colnames(Sig_matrix_EffectivenessCtax_p)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessCtax_p)<-discipline_list




data_selected<-data[,c(62)]#Carbon Market
Sig_matrix_EffectivenessCmar<-matrix(0,15,16)
Sig_matrix_EffectivenessCmar_p<-matrix(1,15,16)
for (i in 1:15){
  for (j in 1:15){
w_test<-wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_EffectivenessCmar[i,j]<-3
Sig_matrix_EffectivenessCmar_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_EffectivenessCmar[i,j]<-2
Sig_matrix_EffectivenessCmar_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_EffectivenessCmar[i,j]<-1
Sig_matrix_EffectivenessCmar_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
  j<-16
  w_test<-kruskal.test(list(data_selected[which(data$Primary_research_field==discipline_list[i])],data$importantpolicies_3),method = "bonferroni",alpha=0.01)
    #wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], g=data$importantpolicies_3,paired = FALSE, alternative = "two.sided")
  if (w_test$p.value<sig_level_1/2){Sig_matrix_EffectivenessCmar[i,j]<-3
  Sig_matrix_EffectivenessCmar_p[i,j]<-w_test$p.value*2}
  else if (w_test$p.value<sig_level_2/2){Sig_matrix_EffectivenessCmar[i,j]<-2
  Sig_matrix_EffectivenessCmar_p[i,j]<-w_test$p.value*2} 
  else if (w_test$p.value<sig_level_3/2){Sig_matrix_EffectivenessCmar[i,j]<-1
  Sig_matrix_EffectivenessCmar_p[i,j]<-w_test$p.value*2}
}
colnames(Sig_matrix_EffectivenessCmar)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessCmar)<-discipline_list
colnames(Sig_matrix_EffectivenessCmar_p)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessCmar_p)<-discipline_list




data_selected<-data[,c(64)]#Innovation Support
Sig_matrix_EffectivenessInns<-matrix(0,15,16)
Sig_matrix_EffectivenessInns_p<-matrix(1,15,16)
for (i in 1:15){
  for (j in 1:15){
w_test<-wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_EffectivenessInns[i,j]<-3
Sig_matrix_EffectivenessInns_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_EffectivenessInns[i,j]<-2
Sig_matrix_EffectivenessInns_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_EffectivenessInns[i,j]<-1
Sig_matrix_EffectivenessInns_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
  j<-16
  w_test<-kruskal.test(list(data_selected[which(data$Primary_research_field==discipline_list[i])],data$importantpolicies_5),method = "bonferroni",alpha=0.01)
    #wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], g=data$importantpolicies_5,paired = FALSE, alternative = "two.sided")
  if (w_test$p.value<sig_level_1/2){Sig_matrix_EffectivenessInns[i,j]<-3
  Sig_matrix_EffectivenessInns_p[i,j]<-w_test$p.value*2}
  else if (w_test$p.value<sig_level_2/2){Sig_matrix_EffectivenessInns[i,j]<-2
  Sig_matrix_EffectivenessInns_p[i,j]<-w_test$p.value*2} 
  else if (w_test$p.value<sig_level_3/2){Sig_matrix_EffectivenessInns[i,j]<-1
  Sig_matrix_EffectivenessInns_p[i,j]<-w_test$p.value*2}
}
colnames(Sig_matrix_EffectivenessInns)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessInns)<-discipline_list
colnames(Sig_matrix_EffectivenessInns_p)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessInns_p)<-discipline_list




data_selected<-data[,c(65)]#Information provision
Sig_matrix_EffectivenessInfp<-matrix(0,15,16)
Sig_matrix_EffectivenessInfp_p<-matrix(1,15,16)
for (i in 1:15){
  for (j in 1:15){
w_test<-wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], data_selected[which(data$Primary_research_field==discipline_list[j])], paired = FALSE, alternative = "greater")
if (w_test$p.value<sig_level_1){Sig_matrix_EffectivenessInfp[i,j]<-3
Sig_matrix_EffectivenessInfp_p[i,j]<-w_test$p.value}
else if (w_test$p.value<sig_level_2){Sig_matrix_EffectivenessInfp[i,j]<-2
Sig_matrix_EffectivenessInfp_p[i,j]<-w_test$p.value}

else if (w_test$p.value<sig_level_3){Sig_matrix_EffectivenessInfp[i,j]<-1
Sig_matrix_EffectivenessInfp_p[i,j]<-w_test$p.value}
#Sig_matrix_Effectiveness[i,j]<-1-w_test$p.value
  }
  j<-16
  w_test<-kruskal.test(list(data_selected[which(data$Primary_research_field==discipline_list[i])],data$importantpolicies_6),method = "bonferroni",alpha=0.01)
    #wilcox.test(data_selected[which(data$Primary_research_field==discipline_list[i])], g=data$importantpolicies_6,paired = FALSE, alternative = "two.sided")
  if (w_test$p.value<sig_level_1/2){Sig_matrix_EffectivenessInfp[i,j]<-3
  Sig_matrix_EffectivenessInfp_p[i,j]<-w_test$p.value*2}
  else if (w_test$p.value<sig_level_2/2){Sig_matrix_EffectivenessInfp[i,j]<-2
  Sig_matrix_EffectivenessInfp_p[i,j]<-w_test$p.value*2} 
  else if (w_test$p.value<sig_level_3/2){Sig_matrix_EffectivenessInfp[i,j]<-1
  Sig_matrix_EffectivenessInfp_p[i,j]<-w_test$p.value*2}
}
colnames(Sig_matrix_EffectivenessInfp)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessInfp)<-discipline_list
colnames(Sig_matrix_EffectivenessInfp_p)<-c(discipline_list,"average")
rownames(Sig_matrix_EffectivenessInfp_p)<-discipline_list


par(mfrow = c(2,3),mar=c(1,1,35,1))

corrplot(Sig_matrix_EffectivenessAsub,title = "Adoption subsidy", 
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_EffectivenessAsub_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,mar=c(0,0,1,0), 
         insig = "label_sig", pch.col = "white")

corrplot(Sig_matrix_EffectivenessCmar, title = "Cap-and-trade",
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_EffectivenessCmar_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,mar=c(0,0,1,0),
         insig = "label_sig", pch.col = "white")


corrplot(Sig_matrix_EffectivenessCtax, title = "Carbon tax",
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_EffectivenessCtax_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,mar=c(0,0,1,0),
         insig = "label_sig", pch.col = "white")


corrplot(Sig_matrix_EffectivenessDreg, title = "Direct regulation",
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_EffectivenessDreg_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,mar=c(0,0,1,0),
         insig = "label_sig", pch.col = "white")

corrplot(Sig_matrix_EffectivenessInfp, title = "Information provision",
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_EffectivenessInfp_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,mar=c(0,0,1,0),
         insig = "label_sig", pch.col = "white")

corrplot(Sig_matrix_EffectivenessInns, title = "Innovation subsidy",
         tl.cex=1,is.corr = FALSE, cl.pos = "n",
         tl.col = "black",cl.lim = c(0,3), p.mat = Sig_matrix_EffectivenessInns_p, 
         method = "square", sig.level = c(.01, .05, .1), pch.cex = .9,mar=c(0,0,1,0),
         insig = "label_sig", pch.col = "white")

options(warn = defaultW)
```

Samll clustering exercise with 15 disciplines. I use mean evaluation of the six policy instruments in the policy mix as six criteri to make clustering on
```{r, echo=FALSE}
#mar=c(10,1,1,10)
#par(mgp=c(8, 5, 8))
library(dendextend)
# ?color_branches
par(mar=c(5 + 5,4,4,2) + 0.1)

data_clustering<-matrix(0,15,7)
data_clustering<-as.data.frame(data_clustering)
colnames(data_clustering)<-c("Discipline","MeanEvaluation_Dreg","MeanEvaluation_Ctax","MeanEvaluation_Cmar","MeanEvaluation_Asub","MeanEvaluation_Inns","MeanEvaluation_Infp")
data_clustering[,1]<-myData$Discipline[1:15]
  data_clustering[,2]<-myData$mean[1:15]
  data_clustering[,3]<-myData$mean[16:30]
  data_clustering[,4]<-myData$mean[31:45]
  data_clustering[,5]<-myData$mean[46:60]
  data_clustering[,6]<-myData$mean[61:75]
  data_clustering[,7]<-myData$mean[76:90]
  rownames(data_clustering)<-myData$Discipline[1:15]
  

clust_dist <- dist(data_clustering[,2:7], method='euclidian')
hier_clust <- hclust(clust_dist, method='complete')

library(stats)
# dist_dend <- as.dendrogram(hier_clust)
# plot(dist_dend) 
plot(as.dendrogram(hier_clust),cex = 0.2)
dend_col <- color_branches(hier_clust, k=5)
plot(dend_col, cex = 0.2)
# plot(dend_col)
# dend_labels <- labels(dend_col)
# text(x = 1:length(dend_labels), labels = dend_labels, srt = 45, adj = c(1,1), xpd = T)

par(mar=c(5,4,4,8) + 0.1)

plot(dend_col, cex = 0.15,horiz=TRUE)


groups <- cutree(hier_clust, h = 1.2)

table(groups)
groups
groups[which(groups==5)]<-11
groups[which(groups==2)]<-12
groups[which(groups==1)]<-13
groups[which(groups==3)]<-14
groups[which(groups==4)]<-15


data_clustering$cluster<-groups

data_clustering2<-matrix(0,5,7)
data_clustering2<-as.data.frame(data_clustering2)
colnames(data_clustering2)<-c("Discipline","MeanEvaluation_Dreg","MeanEvaluation_Ctax","MeanEvaluation_Cmar","MeanEvaluation_Asub","MeanEvaluation_Inns","MeanEvaluation_Infp")
data_clustering2[,1]<-c('Sociology + psychology','Ecol. economics', "Other sciences","Env./oth. econ. + law","Math & comp. sci")
  data_clustering2[,2]<-c(mean(data_clustering$MeanEvaluation_Dreg[which(data_clustering$cluster==11)]),mean(data_clustering$MeanEvaluation_Dreg[which(data_clustering$cluster==12)]),mean(data_clustering$MeanEvaluation_Dreg[which(data_clustering$cluster==13)]),mean(data_clustering$MeanEvaluation_Dreg[which(data_clustering$cluster==14)]),mean(data_clustering$MeanEvaluation_Dreg[which(data_clustering$cluster==15)]))
  data_clustering2[,3]<-c(mean(data_clustering$MeanEvaluation_Ctax[which(data_clustering$cluster==11)]),mean(data_clustering$MeanEvaluation_Ctax[which(data_clustering$cluster==12)]),mean(data_clustering$MeanEvaluation_Ctax[which(data_clustering$cluster==13)]),mean(data_clustering$MeanEvaluation_Ctax[which(data_clustering$cluster==14)]),mean(data_clustering$MeanEvaluation_Ctax[which(data_clustering$cluster==15)]))
  data_clustering2[,4]<-c(mean(data_clustering$MeanEvaluation_Cmar[which(data_clustering$cluster==11)]),mean(data_clustering$MeanEvaluation_Cmar[which(data_clustering$cluster==12)]),mean(data_clustering$MeanEvaluation_Cmar[which(data_clustering$cluster==13)]),mean(data_clustering$MeanEvaluation_Cmar[which(data_clustering$cluster==14)]),mean(data_clustering$MeanEvaluation_Cmar[which(data_clustering$cluster==15)]))
  data_clustering2[,5]<-c(mean(data_clustering$MeanEvaluation_Asub[which(data_clustering$cluster==11)]),mean(data_clustering$MeanEvaluation_Asub[which(data_clustering$cluster==12)]),mean(data_clustering$MeanEvaluation_Asub[which(data_clustering$cluster==13)]),mean(data_clustering$MeanEvaluation_Asub[which(data_clustering$cluster==14)]),mean(data_clustering$MeanEvaluation_Asub[which(data_clustering$cluster==15)]))
  data_clustering2[,6]<-c(mean(data_clustering$MeanEvaluation_Inns[which(data_clustering$cluster==11)]),mean(data_clustering$MeanEvaluation_Inns[which(data_clustering$cluster==12)]),mean(data_clustering$MeanEvaluation_Inns[which(data_clustering$cluster==13)]),mean(data_clustering$MeanEvaluation_Inns[which(data_clustering$cluster==14)]),mean(data_clustering$MeanEvaluation_Inns[which(data_clustering$cluster==15)]))
  data_clustering2[,7]<-c(mean(data_clustering$MeanEvaluation_Infp[which(data_clustering$cluster==11)]),mean(data_clustering$MeanEvaluation_Infp[which(data_clustering$cluster==12)]),mean(data_clustering$MeanEvaluation_Infp[which(data_clustering$cluster==13)]),mean(data_clustering$MeanEvaluation_Infp[which(data_clustering$cluster==14)]),mean(data_clustering$MeanEvaluation_Infp[which(data_clustering$cluster==15)]))
  rownames(data_clustering2)<-c('Sociology + psychology','Ecol. economics', "Other sciences","Env./oth. econ. + law","Math & comp. sci")
  
  
g1<-ggplot(data = data_clustering2, aes(x = Discipline, y = MeanEvaluation_Dreg))+ 
  # geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Question),
  #               position= position_dodge(0.5), width = 0.2) +
  geom_point(position = position_dodge(0.5)) +
  labs(x = "", y = "Direct regulation")+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=mean(data_clustering$MeanEvaluation_Dreg), linetype="dashed", color = "black")+ theme(legend.position="bottom")+
  ylim(2.5, 4.5)#+

g2<-ggplot(data = data_clustering2, aes(x = Discipline, y = MeanEvaluation_Ctax))+ 
  # geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Question),
  #               position= position_dodge(0.5), width = 0.2) +
  geom_point(position = position_dodge(0.5)) +
  labs(x = "", y = "Carbon tax")+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=mean(data_clustering$MeanEvaluation_Ctax), linetype="dashed", color = "black")+ theme(legend.position="bottom")+
  ylim(2.5, 4.5)#+

g3<-ggplot(data = data_clustering2, aes(x = Discipline, y = MeanEvaluation_Cmar))+ 
  # geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Question),
  #               position= position_dodge(0.5), width = 0.2) +
  geom_point(position = position_dodge(0.5)) +
  labs(x = "", y = "Cap-and-trade")+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=mean(data_clustering$MeanEvaluation_Cmar), linetype="dashed", color = "black")+ theme(legend.position="bottom")+
  ylim(2.5, 4.5)#+

g4<-ggplot(data = data_clustering2, aes(x = Discipline, y = MeanEvaluation_Asub))+ 
  # geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Question),
  #               position= position_dodge(0.5), width = 0.2) +
  geom_point(position = position_dodge(0.5)) +
  labs(x = "", y = "Adoption subsidies")+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=mean(data_clustering$MeanEvaluation_Asub), linetype="dashed", color = "black")+ theme(legend.position="bottom")+
  ylim(2.5, 4.5)#+


g5<-ggplot(data = data_clustering2, aes(x = Discipline, y = MeanEvaluation_Inns))+ 
  # geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Question),
  #               position= position_dodge(0.5), width = 0.2) +
  geom_point(position = position_dodge(0.5)) +
  labs(x = "", y = "Innovation support")+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=mean(data_clustering$MeanEvaluation_Inns), linetype="dashed", color = "black")+ theme(legend.position="bottom")+
  ylim(2.5, 4.5)#+


g6<-ggplot(data = data_clustering2, aes(x = Discipline, y = MeanEvaluation_Infp))+ 
  # geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Question),
  #               position= position_dodge(0.5), width = 0.2) +
  geom_point(position = position_dodge(0.5)) +
  labs(x = "", y = "Information provision")+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=mean(data_clustering$MeanEvaluation_Infp), linetype="dashed", color = "black")+ theme(legend.position="bottom")+
  ylim(2.5, 4.5)#+
  
grid.arrange(g1, g2, g3, g4,g5,g6, nrow = 2)

```

Plot the distribution of responses (agreement/disagreement) with the ten statements.

```{r, echo=FALSE}

for (ic in 70:79){
  data[which(is.na(data[,ic])),ic]<-6
}

Distribution_of_responses<-matrix(0,6,10)
Distribution_of_responses[,1]<-table(data$CPstatements_p1_1)
Distribution_of_responses[,2]<-table(data$CPstatements_p1_2)
Distribution_of_responses[,3]<-table(data$CPstatements_p1_3)
Distribution_of_responses[,4]<-table(data$CPstatements_p1_4)
Distribution_of_responses[,5]<-table(data$CPstatements_p1_5)
Distribution_of_responses[,6]<-table(data$CPstatements_p2_6)
Distribution_of_responses[,7]<-table(data$CPstatements_p2_7)
Distribution_of_responses[,8]<-table(data$CPstatements_p2_8)
Distribution_of_responses[,9]<-table(data$CPstatements_p2_9)
Distribution_of_responses[,10]<-table(data$CPstatements_p2_10)

wrap.it <- function(x, len)
{ 
  sapply(x, function(y) paste(strwrap(y, len), 
                              collapse = "\n"), 
         USE.NAMES = FALSE)
}

# Call this function with a list or vector
wrap.labels <- function(x, len)
{
  if (is.list(x))
  {
    lapply(x, wrap.it, len)
  } else {
    wrap.it(x, len)
  }
}

names_questions=c(
"Since carbon pricing alters relative prices, firms and consumers automatically account for climate-change effects of their decisions (Costs_internalization)",

"Carbon pricing has little impact on the speed of low-carbon innovation (Innovation_speed)",

 "Carbon pricing is the most effective instrument to limit energy/carbon rebound. An example of rebound is driving more kilometres after buying a more fuel-efficient car (Rebound)",

 "Carbon pricing promotes emissions reduction at the margin but cannot stimulate major changes necessary for achieving zero carbon emissions (Small_change)",

"Carbon pricing decentralizes policy, reducing regulators' need for information (Decentralized_policy)",

"Contextual, sector-specific climate policies are more effective in terms of overall emissions reduction than economy-wide carbon pricing (Contextual_policy)",

"Carbon pricing takes into account that in making purchasing decisions, most consumers are more influenced by prices than by environmental concerns (Price_sensitivity)", 

"Carbon pricing can be more easily up-scaled and harmonized globally than other instruments (Policy_harmonization)",

"Carbon pricing performs worse than other instruments when consumers and firms do not  make rational choices (Bounded_rationality)",

"A unique advantage of carbon pricing over other instruments is that it generates public revenues which can be used for multiple purposes (Public_revenues)")

wr.lap <- wrap.labels(names_questions,100)
colmap<-c(colorRampPalette(c("red","green"))(5),"#FFFFFF")

par(mfrow = c(1, 1) ,mar=c(7,25,1,1))
barplot(Distribution_of_responses[,(seq(10,1,by=-1))],main="",
        xlab="", col=colmap,
        horiz = TRUE,
        names.arg = rev(wr.lap),#reorder(wr.lap,seq(6,1,by=-1)),
        cex.names=0.6,
        legend = c("Strongly disagree","Somewhat disagree","Neither nor","Somewhat agree","Strongly agree","Do not know/No answer"),
        args.legend = list(x="bottomright",bty="n", inset=c(0,-.4), xpd = TRUE,ncol=3),
        #beside=TRUE,
        las=2)

Distribution_of_responses

Distribution_of_responses_pc<-Distribution_of_responses/sum(Distribution_of_responses[,1])*100

par(mfrow = c(1, 1) ,mar=c(7,25,1,1))
barplot(Distribution_of_responses_pc[,(seq(10,1,by=-1))],main="",
        xlab="%", col=colmap,
        horiz = TRUE,
        names.arg = rev(wr.lap),#reorder(wr.lap,seq(6,1,by=-1)),
        cex.names=0.6,
        legend = c("Strongly disagree","Somewhat disagree","Neither nor","Somewhat agree","Strongly agree","Do not know/No answer"),
        args.legend = list(x="bottomright",bty="n", inset=c(0.,-.4), xpd = TRUE,ncol=3),
        #beside=TRUE,
        las=2)
```


I also clustered respondents who answered the 10 statements on carbon pricing using LCA. Note that I discarded anyone who did not answer at least one of the statements or gave "I do not know" response.
Therefore, out 0f 789 observations, we are dealing with 571 only!

I obtain three clusters. We clearly see that on some statements opinion of the clusters is not so diffeerent:

5 "Carbon pricing decentralizes policy, reducing regulators' need for information.",

7  "Carbon pricing takes into account that in making purchasing decisions, most consumers are more influenced by prices than by environmental concerns.", 

10  "A unique advantage of carbon pricing over other instruments is that it generates public revenues which can be used for multiple purposes."

But on other statement the views between clusters 1 and 3 are very different.

Cluster 1 is skeptical about carbon pricing agreeing with statements:

2 "Carbon pricing has little impact on the speed of low-carbon innovation.",

4 "Carbon pricing promotes emissions reduction at the margin but cannot stimulate major changes necessary for achieving zero carbon emissions.",

6 "Contextual, sector-specific climate policies are more effective in terms of overall emissions reduction than economy-wide carbon pricing.",

9 "Carbon pricing performs worse than other instruments when consumers and firms do not  make rational choices.",

 Cluster 3 in contrast are supporting CP siagreeing on the abovementioned statements and additionally stronger than other clusters agreeing with statement:
 
 1"Since carbon pricing alters relative prices, firms and consumers automatically account for climate-change effects of their decisions.",
 
 3 "Carbon pricing is the most effective instrument to limit energy/carbon rebound. An example of rebound is driving more kilometres after buying a more fuel-efficient car.",
 
 8"Carbon pricing can be more easily up-scaled and harmonized globally than other instruments."
 
 
 According to the last chart and the regressions, cluster 3 (enthusiasts) is concentrated in disciplines like Psychology, Computer science and Env economics, while skepticists are (nonsignificantly) concentrated in political science, Oth Env Soc Sci and sustainability transition
 
 Finally, the confusion matrix shows that enthusiasts of CP are relatively more common among GreenGrowth and Agrowth supporters, while Degrowth supporters are rather equally distributed among CP skepticists and enthusiasts

```{r, echo=FALSE}

for (ic in 70:79){
  data[which(data[,ic]==6),ic]<-NA
}


colnames(data)[70:79]<-c("CPstatementsZCosts_internalization","CPstatementsZInnovation_speed","CPstatementsZRebound","CPstatementsZSmall_change","CPstatementsZDecentralized_policy","CPstatementsZContextual_policy","CPstatementsZPrice_sensitivity","CPstatementsZPolicy_harmonization","CPstatementsZBounded_rationality","CPstatementsZPublic_revenues")

list_CA_cluster<-seq(1,length(data$STATUS),by=1)[-c(which(is.na(data[,70])),which(is.na(data[,71])),which(is.na(data[,72])),which(is.na(data[,73])),which(is.na(data[,74])),which(is.na(data[,75])),which(is.na(data[,76])),which(is.na(data[,77])),which(is.na(data[,78])),which(is.na(data[,79]))   )]


f<-with(data, cbind(CPstatementsZCosts_internalization,CPstatementsZInnovation_speed,CPstatementsZRebound,CPstatementsZSmall_change,CPstatementsZDecentralized_policy,CPstatementsZContextual_policy,CPstatementsZPrice_sensitivity,CPstatementsZPolicy_harmonization,CPstatementsZBounded_rationality,CPstatementsZPublic_revenues)~1) 

set.seed(01012)
lc1 <- poLCA(f, maxiter=1000, nclass=1, nrep=10, data=data, verbose=FALSE)
lc2 <- poLCA(f, maxiter=1000, nclass=2, nrep=10, data=data, verbose=FALSE)
lc3 <- poLCA(f, maxiter=1000, nclass=3, nrep=10, data=data, verbose=FALSE)
lc4 <- poLCA(f, maxiter=1000, nclass=4, nrep=10, data=data, verbose=FALSE)
lc5 <- poLCA(f, maxiter=1000, nclass=5, nrep=10, data=data, verbose=FALSE)
lc6 <- poLCA(f, maxiter=1000, nclass=6, nrep=10, data=data, verbose=FALSE)
lc7 <- poLCA(f, maxiter=1000, nclass=7, nrep=10, data=data, verbose=FALSE)
lc8 <- poLCA(f, maxiter=1000, nclass=8, nrep=10, data=data, verbose=FALSE)
lc9 <- poLCA(f, maxiter=1000, nclass=9, nrep=10, data=data, verbose=FALSE)

# generate dataframe with fit-values

results <- data.frame(Modell=c("Modell 1"),
                      log_likelihood=lc1$llik,
                      df = lc1$resid.df,
                      BIC=lc1$bic,
                      ABIC=  (-2*lc1$llik) + ((log((lc1$N + 2)/24)) * lc1$npar),
                      CAIC = (-2*lc1$llik) + lc1$npar * (1 + log(lc1$N)), 
                      likelihood_ratio=lc1$Gsq)
results$Modell<-as.integer(results$Modell)
results[1,1]<-c("1 cluster")
results[2,1]<-c("2 clusters")
results[3,1]<-c("3 clusters")
results[4,1]<-c("4 clusters")
results[5,1]<-c("5 clusters")
results[6,1]<-c("6 clusters")
results[7,1]<-c("7 clusters")
results[8,1]<-c("8 clusters")
results[9,1]<-c("9 clusters")

results[2,2]<-lc2$llik
results[3,2]<-lc3$llik
results[4,2]<-lc4$llik
results[5,2]<-lc5$llik
results[6,2]<-lc6$llik
results[7,2]<-lc7$llik
results[8,2]<-lc8$llik
results[9,2]<-lc9$llik

results[2,3]<-lc2$resid.df
results[3,3]<-lc3$resid.df
results[4,3]<-lc4$resid.df
results[5,3]<-lc5$resid.df
results[6,3]<-lc6$resid.df
results[7,3]<-lc7$resid.df
results[8,3]<-lc8$resid.df
results[9,3]<-lc9$resid.df

results[2,4]<-lc2$bic
results[3,4]<-lc3$bic
results[4,4]<-lc4$bic
results[5,4]<-lc5$bic
results[6,4]<-lc6$bic
results[7,4]<-lc7$bic
results[8,4]<-lc8$bic
results[9,4]<-lc9$bic

results[2,5]<-(-2*lc2$llik) + ((log((lc2$N + 2)/24)) * lc2$npar) #abic
results[3,5]<-(-2*lc3$llik) + ((log((lc3$N + 2)/24)) * lc3$npar)
results[4,5]<-(-2*lc4$llik) + ((log((lc4$N + 2)/24)) * lc4$npar)
results[5,5]<-(-2*lc5$llik) + ((log((lc5$N + 2)/24)) * lc5$npar)
results[6,5]<-(-2*lc6$llik) + ((log((lc6$N + 2)/24)) * lc6$npar)
results[7,5]<-(-2*lc7$llik) + ((log((lc7$N + 2)/24)) * lc7$npar) 
results[8,5]<-(-2*lc8$llik) + ((log((lc8$N + 2)/24)) * lc8$npar) 
results[9,5]<-(-2*lc9$llik) + ((log((lc9$N + 2)/24)) * lc9$npar) 

results[2,6]<- (-2*lc2$llik) + lc2$npar * (1 + log(lc2$N)) #caic
results[3,6]<- (-2*lc3$llik) + lc3$npar * (1 + log(lc3$N))
results[4,6]<- (-2*lc4$llik) + lc4$npar * (1 + log(lc4$N))
results[5,6]<- (-2*lc5$llik) + lc5$npar * (1 + log(lc5$N))
results[6,6]<- (-2*lc6$llik) + lc6$npar * (1 + log(lc6$N))
results[7,6]<- (-2*lc7$llik) + lc7$npar * (1 + log(lc7$N))
results[8,6]<- (-2*lc8$llik) + lc8$npar * (1 + log(lc8$N))
results[9,6]<- (-2*lc9$llik) + lc9$npar * (1 + log(lc9$N))

results[2,7]<-lc2$Gsq
results[3,7]<-lc3$Gsq
results[4,7]<-lc4$Gsq
results[5,7]<-lc5$Gsq
results[6,7]<-lc6$Gsq
results[7,7]<-lc7$Gsq
results[8,7]<-lc8$Gsq
results[9,7]<-lc9$Gsq


entropy<-function (p) sum(-p*log(p))

results$R2_entropy
results[1,8]<-c("-")

error_prior<-entropy(lc2$P) # class proportions model 2
error_post<-mean(apply(lc2$posterior,1, entropy),na.rm = TRUE)
results[2,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc3$P) # class proportions model 3
error_post<-mean(apply(lc3$posterior,1, entropy),na.rm = TRUE)
results[3,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc4$P) # class proportions model 4
error_post<-mean(apply(lc4$posterior,1, entropy),na.rm = TRUE)
results[4,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc5$P) # class proportions model 5
error_post<-mean(apply(lc5$posterior,1, entropy),na.rm = TRUE)
results[5,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc6$P) # class proportions model 6
error_post<-mean(apply(lc6$posterior,1, entropy),na.rm = TRUE)
results[6,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc7$P) # class proportions model 6
error_post<-mean(apply(lc7$posterior,1, entropy),na.rm = TRUE)
results[7,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc8$P) # class proportions model 6
error_post<-mean(apply(lc8$posterior,1, entropy),na.rm = TRUE)
results[8,8]<-round(((error_prior-error_post) / error_prior),3)

error_prior<-entropy(lc9$P) # class proportions model 6
error_post<-mean(apply(lc9$posterior,1, entropy),na.rm = TRUE)
results[9,8]<-round(((error_prior-error_post) / error_prior),3)

# combining results to a dataframe
colnames(results)<-c("Model","log-likelihood","resid. df","BIC","aBIC","cAIC","likelihood-ratio","Entropy")
lca_results<-results

#results





# ELBOW DIAGRAM

# Order categories of results$model in order of appearance
#install.packages("forcats")
library("forcats")
#results$model < - as_factor(results$model) 

#convert to long format
results2<-tidyr::gather(results,Kriterium,Guete,4:6)
#results2

#plot 
fit.plot<-ggplot(results2) + 
  geom_point(aes(x=Model,y=Guete),size=3) +
  geom_line(aes(Model, Guete, group = 1)) +
  theme_bw()+
  labs(x = "", y="", title = "") + 
  facet_grid(Kriterium ~. ,scales = "free") +
  theme_bw(base_size = 16, base_family = "") +   
  theme(panel.grid.major.x = element_blank() ,
        panel.grid.major.y = element_line(colour="grey", size=0.5),
        legend.title = element_text(size = 16, face = 'bold'),
        axis.text = element_text(size = 12),
        axis.text.x = element_text(size = 12, angle = 45, hjust = 1),
        axis.title = element_text(size = 16),
        legend.text=  element_text(size=16),
        axis.line = element_line(colour = "black")) # Achsen etwas dicker

# save 650 x 800
fit.plot




#Assume that we stick to x classes, show their size
round(colMeans(lc3$posterior)*100,2)
index_i<-apply(lc3$posterior, 1, which.max)# find for each id, the  identified class

#index_i[index_i==1]<-5
table(index_i)
data$class_CT<-matrix(NA,length(data$STATUS),1)
data$class_CT[list_CA_cluster]<-index_i

# data_clust$class_LCA[index_i==1]<-2
# data_clust$class_LCA[index_i==2]<-1
# data_clust$class_LCA[index_i==3]<-3
#data_clust$class_LCA[index_i==4]<-"cluster4PubSur"

data$class_CT<-as.factor(data$class_CT)

m_change <- polr(class_CT ~   Primary_research_field+1 
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

data$class_CT<-as.numeric(data$class_CT)
m_change <- lm(class_CT ~   Primary_research_field 
                 , data = data)
summary(m_change)


data$DisciplineClusterS<-matrix(0,length(data$STATUS),1)
data$DisciplineClusterS[which(data$Primary_research_field %in% c("Agri./forestry","Engineering","Geography","Ind. ecology","Natural sci.","Oth. env. soc. sci.","Political sci.","Sust. transition"))]<-3
data$DisciplineClusterS[which(data$Primary_research_field %in% c("Ecol. economics"))]<-4
data$DisciplineClusterS[which(data$Primary_research_field %in% c("Env. economics","Law","Oth. economics"))]<-2
data$DisciplineClusterS[which(data$Primary_research_field %in% c("Math & comp. sci."))]<-1
data$DisciplineClusterS[which(data$Primary_research_field %in% c("Sociology","Psychology"))]<-5



data_long<-reshape(data[list_CA_cluster,], direction = "long", varying = names(data)[70:79], idvar = "Response.ID", sep="Z",timevar="Question")
#plotting responses with respect to resulted clustering
p <- ggplot(data = data_long, aes(x=Question, y=CPstatements)) + 
  geom_boxplot(aes(fill=as.factor(class_CT)))  
p + facet_wrap( ~ Question, scales="free")+  
  scale_fill_manual(values=c("magenta","cyan","limegreen"),  name="", breaks=c("1","2","3"),
                    labels=c("CP skeptics", "CP undecided","CP enthusiasts"))+ 
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        legend.position="bottom")



p <- ggplot(data = data_long, aes(x=Question, y=CPstatements)) + 
  geom_boxplot(aes(fill=as.factor(DisciplineClusterS)))  
p + facet_wrap( ~ Question, scales="free")+  
  scale_fill_manual(values=c("magenta","cyan","limegreen",'orange','brown'),  name="", breaks=c("1","2","3",'4','5'),
                    labels=c("Math & comp. sci", "Env./oth. econ. + law","Other sciences",'Ecol. economics','Sociology + psychology'))+ 
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        legend.position="bottom")+guides(fill=guide_legend(nrow=2,byrow=TRUE))





data_long<-data[,c(1,16,103)]
names(data_long)<-c("Response.ID","Discipline","class_CT")

myData <- aggregate(data_long$class_CT,
                    by = list(data_long$Discipline),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
#myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline", "mean", "sd", "n", "se")



ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "class_CT (Support)")+
geom_point( position = position_dodge(0.5)) +
  #scale_fill_discrete(name = "Instrument", labels=c("Direct regulation", "Carbon tax","Cap-and-trade","Adoption subsidies","Innovation support","Information provision"))+
  #scale_x_discrete(labels = c('0','1','2','3','4','5'))+ 
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))



conf_matrix<-table(data$GEMcluster,data$class_CT)
#conf_matrix<-as.data.frame(conf_matrix)
rownames(conf_matrix)<-c("GreenGrowth","Agrowth","Degrowth")
colnames(conf_matrix)<-c("CP skeptics","CP undecided","CP enthusiasts")
conf_matrix
rowSums(conf_matrix)
colSums(conf_matrix)


# Create data
data_stack <- matrix(0,15, 3)
colnames(data_stack) <- c("CP skeptics","CP undecided","CP enthusiasts")
rownames(data_stack) <- discipline_list
ii<-1

for (i in discipline_list){
  for (j in 1:3){
  data_stack[ii,j]<-sum(data[which(data$Primary_research_field==i),103]==j,na.rm=TRUE)
  }
  ii<-ii+1
}
 
# create color palette:
library(RColorBrewer)
coul <- brewer.pal(3, "Pastel2") 
 
# Transform this data in %
data_percentage <- apply(data_stack, 1, function(x){x*100/sum(x,na.rm=T)})
 
# Make a stacked barplot--> it will be in %!
par(mar=c(0,0,0,0) )
barplot(data_percentage, col=coul , border="white", las=2)
       # legend = c("Climate","PoorHH","AllHH"),cex.names=1.3,las=2,ylab="Number of respondents",cex.axis=1.3,cex.lab=1.3, args.legend = list(x="topleft",ncol=1,cex=1.3,bty="n")
        #legend=colnames(data_stack),args.legend = list(x="topleft",ncol=1,cex=1.3,bty="n")
       legend(x = "right", legend = colnames(data_stack),  ncol = 1)
       
opar = par(oma = c(7,2,2,2))
barplot(data_percentage, col=coul , border="white", las=2)
par(opar)

opar =par(oma = c(0,0,0,0), mar = c(0,0,0,0), new = TRUE)
legend(x = "top", legend = colnames(data_stack), fill = coul, bty = "n", ncol = 3, inset = -0)
#text(rownames(data_stack),srt = 10, adj = 1, xpd = TRUE)

par(opar)


par(mar=c(0,0,0,0) )
barplot(data_percentage, col=coul , border="white", las=2, horiz = TRUE)
       # legend = c("Climate","PoorHH","AllHH"),cex.names=1.3,las=2,ylab="Number of respondents",cex.axis=1.3,cex.lab=1.3, args.legend = list(x="topleft",ncol=1,cex=1.3,bty="n")
        #legend=colnames(data_stack),args.legend = list(x="topleft",ncol=1,cex=1.3,bty="n")
       legend(x = "right", legend = colnames(data_stack),  ncol = 1)
       
opar = par(oma = c(4,9,2,2))
barplot(data_percentage, xlab="%", col=coul , border="white",
        las=1, horiz = TRUE)
par(opar)

opar =par(oma = c(0,0,0,0), mar = c(0,0,0,0), new = TRUE)
legend(x = "top", legend = colnames(data_stack), fill = coul, bty = "n", ncol = 3, inset = -0)
#text(rownames(data_stack),srt = 10, adj = 1, xpd = TRUE)

par(opar)
# 
# barplot(Distribution_of_responses_pc[,(seq(10,1,by=-1))],main="",
#         xlab="%", col=colmap,
#         horiz = TRUE,
#         names.arg = rev(wr.lap),#reorder(wr.lap,seq(6,1,by=-1)),
#         cex.names=0.6,
#         legend = c("Strongly disagree","Somewhat disagree","Neither nor","Somewhat agree","Strongly agree","Do not know/No answer"),
#         args.legend = list(x="bottomright",bty="n", inset=c(0.,-.4), xpd = TRUE,ncol=3),
#         #beside=TRUE,
#         las=2)

 #theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1))+
```

Here I regress the importance with which researchers rated carbon tax and carbon market on the 10 statements and some basic controls (note that if I include disciplines or countries the table will get much larger. later I can do it but results do not seem to change a lot because of them)

We see that several statement (in particular, the 3rd and the 8th) play a significant and sizable role in explaining scientists preferences. Also, the statements better explain preference regarding carbon tax than carbon market (compare R2 in the two cases)
```{r, echo=FALSE}
#reminder of the order
#•	[1] Direct regulation (e.g. technical standards, quotas) (importance_regulation)
# •	[2] Carbon tax (importance_ctax)
# •	[3] Cap-and-trade (importance_cap_trade)
# •	[4] Adoption subsidies (importance_adoption_subsidies)
# •	[5] Innovation support (e.g. R&D subsidies) (importance_innovation_support)
# •	[6] Information provision (e.g. education, ecolabels) (importance_information)
# •	[7] Other, please specify (optional) (importance_other) [SPECIFY]
library(DescTools)
data$continent<-matrix(NA,length(data$country_residence),1)

data$continent[which(data$country_residence %in% c('Canada','Mexico','United States of America'))]<-"North America"
data$continent[which(data$country_residence %in% c('Argentina','Brazil','Chile','Colombia','Costa Rica','Cuba','Peru'))]<-"South America"
data$continent[which(data$country_residence %in% c('Austria','Belgium','Croatia','Czech Republic','Denmark','Finland','France','Germany','Greece','Hungary','Ireland','Italy','Latvia','Lithuania','Luxembourg','Netherlands','North Macedonia','Norway','Poland','Portugal','Romania','Russia','Serbia','Slovakia','Sweden','Switzerland','Spain','Ukraine','United Kingdom'))]<-"Europe"
data$continent[which(data$country_residence %in% c('Bangladesh','China','Iran','India','Indonesia','Japan','Kazakhstan','Lebanon','Malaysia','Nepal','Pakistan','Philippines','Saudi Arabia','Singapore','South Korea','Sri Lanka','Thailand','Taiwan','Turkey','United Arab Emirates','Vietnam'))]<-"Asia"
data$continent[which(data$country_residence %in% c('Australia','New Zealand'))]<-"Oceania"
data$continent[which(data$country_residence %in% c('Benin','Cameroon','Ethiopia','Ghana','Kenya','Namibia','Niger','Nigeria','South Africa','Uganda','Zimbabwe'))]<-"Africa"
data$continent[which(data$country_residence %in% c('Other'))]<-NA  
table(data$continent)                     
data$continent<-as.factor(data$continent)


data$importance_Dreg<-as.factor(data$importantpolicies_1)
data$importance_Ctax<-as.factor(data$importantpolicies_2)
data$importance_Cmarket<-as.factor(data$importantpolicies_3)
data$importance_Asub<-as.factor(data$importantpolicies_4)
data$importance_Inns<-as.factor(data$importantpolicies_5)
data$importance_Infp<-as.factor(data$importantpolicies_6)

data$Primary_research_field<-as.factor(data$Primary_research_field)

data$DisciplineCluster<-matrix(0,length(data$STATUS),1)
data$DisciplineCluster[which(data$Primary_research_field %in% c("Agri./forestry","Engineering","Geography","Ind. ecology","Natural sci.","Oth. env. soc. sci.","Political sci.","Sust. transition"))]<-1
data$DisciplineCluster2<-matrix(0,length(data$STATUS),1)
data$DisciplineCluster2[which(data$Primary_research_field %in% c("Ecol. economics"))]<-1
data$DisciplineCluster3<-matrix(0,length(data$STATUS),1)
data$DisciplineCluster3[which(data$Primary_research_field %in% c("Env. economics","Law","Oth. economics"))]<-1
data$DisciplineCluster4<-matrix(0,length(data$STATUS),1)

data$DisciplineCluster4[which(data$Primary_research_field %in% c("Math & comp. sci."))]<-1
data$DisciplineCluster5<-matrix(0,length(data$STATUS),1)

data$DisciplineCluster5[which(data$Primary_research_field %in% c("Sociology","Psychology"))]<-1

print("importance_Ctax")
m_change <- polr(importance_Ctax ~
                   CPstatementsZCosts_internalization+CPstatementsZInnovation_speed+CPstatementsZRebound+CPstatementsZSmall_change+CPstatementsZDecentralized_policy+CPstatementsZContextual_policy+CPstatementsZPrice_sensitivity+CPstatementsZPolicy_harmonization+CPstatementsZBounded_rationality+CPstatementsZPublic_revenues+criteria_1 +criteria_2 +criteria_3 +criteria_4 #+ Primary_research_field 
                 + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics + DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

print("importance_Cmarket")
m_change <- polr(importance_Cmarket ~ CPstatementsZCosts_internalization+CPstatementsZInnovation_speed+CPstatementsZRebound+CPstatementsZSmall_change+CPstatementsZDecentralized_policy+CPstatementsZContextual_policy+CPstatementsZPrice_sensitivity+CPstatementsZPolicy_harmonization+CPstatementsZBounded_rationality+CPstatementsZPublic_revenues +criteria_1 +criteria_2 +criteria_3 +criteria_4 #+ Primary_research_field 
                 + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics + DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

print("importance_Ctax")
m_change <- polr(importance_Ctax ~ CPstatementsZCosts_internalization+CPstatementsZInnovation_speed+CPstatementsZRebound+CPstatementsZSmall_change+CPstatementsZDecentralized_policy+CPstatementsZContextual_policy+CPstatementsZPrice_sensitivity+CPstatementsZPolicy_harmonization+CPstatementsZBounded_rationality+CPstatementsZPublic_revenues 
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

print("importance_Cmarket")
m_change <- polr(importance_Cmarket ~ CPstatementsZCosts_internalization+CPstatementsZInnovation_speed+CPstatementsZRebound+CPstatementsZSmall_change+CPstatementsZDecentralized_policy+CPstatementsZContextual_policy+CPstatementsZPrice_sensitivity+CPstatementsZPolicy_harmonization+CPstatementsZBounded_rationality+CPstatementsZPublic_revenues  
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")


print("importance_Dreg")
m_change <- polr(importance_Dreg ~ CPstatementsZCosts_internalization+CPstatementsZInnovation_speed+CPstatementsZRebound+CPstatementsZSmall_change+CPstatementsZDecentralized_policy+CPstatementsZContextual_policy+CPstatementsZPrice_sensitivity+CPstatementsZPolicy_harmonization+CPstatementsZBounded_rationality+CPstatementsZPublic_revenues 
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

print("importance_Asub")
m_change <- polr(importance_Asub ~ CPstatementsZCosts_internalization+CPstatementsZInnovation_speed+CPstatementsZRebound+CPstatementsZSmall_change+CPstatementsZDecentralized_policy+CPstatementsZContextual_policy+CPstatementsZPrice_sensitivity+CPstatementsZPolicy_harmonization+CPstatementsZBounded_rationality+CPstatementsZPublic_revenues  
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

print("importance_Inns")
m_change <- polr(importance_Inns ~ CPstatementsZCosts_internalization+CPstatementsZInnovation_speed+CPstatementsZRebound+CPstatementsZSmall_change+CPstatementsZDecentralized_policy+CPstatementsZContextual_policy+CPstatementsZPrice_sensitivity+CPstatementsZPolicy_harmonization+CPstatementsZBounded_rationality+CPstatementsZPublic_revenues  
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

print("importance_Infp")
m_change <- polr(importance_Infp ~ CPstatementsZCosts_internalization+CPstatementsZInnovation_speed+CPstatementsZRebound+CPstatementsZSmall_change+CPstatementsZDecentralized_policy+CPstatementsZContextual_policy+CPstatementsZPrice_sensitivity+CPstatementsZPolicy_harmonization+CPstatementsZBounded_rationality+CPstatementsZPublic_revenues 
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
```
some descriptive statistics on second order beliefs.
People in env economics, law, other economics, eco economics and sustainability have highest second order beliefs. People in CompSci and Othe Soc Sci - the lowest

```{r, echo=FALSE}


data_long<-data[,c(1,16,81)]
names(data_long)<-c("Response.ID","Discipline","Second_order_belief")

summary(data_long$Second_order_belief)


myData <- aggregate(data_long$Second_order_belief,
                    by = list(data_long$Discipline),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline", "mean", "sd", "n", "se")


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "Discipline", y = "Second_order_belief")+
  geom_point(, position = position_dodge(0.5)) +
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=50, linetype="dashed", color = "red")

myData


data$CPsupport<-matrix(0,length(data$STATUS),1)
data$CPsupport[which(rowSums(data[,61:62],na.rm=TRUE)>=8)]<-1
data$CPsupportPercent<-matrix(0,length(data$STATUS),1)
for (i in 1:length(data$CPsupport)){
data$CPsupportPercent[i]<-sum(data$CPsupport[which(data$Primary_research_field==data$Primary_research_field[i])])/length(data$CPsupport[which(data$Primary_research_field==data$Primary_research_field[i])])*100
}

data_long<-data[,c(1,16,81,116)]
names(data_long)<-c("Response.ID","Discipline","OrderBelief_second","OrderBelief_first")
data_long<-reshape(data_long, direction = "long", varying = names(data_long)[3:4], idvar = "Response.ID", sep="_",timevar="Question")



myData <- aggregate(data_long$OrderBelief,
                    by = list(data_long$Discipline,data_long$Question),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline", 'Question',"mean", "sd", "n", "se")



ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Question),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "", y = "Expected vs. actual importance of carbon pricing (in %)")+
  geom_point(aes(color = Question), position = position_dodge(0.5)) +
  scale_colour_discrete(name = "", breaks = c("first", "second"), labels=c("actual", "expected"))+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=50, linetype="dashed", color = "black")#+
 # scale_fill_manual(name = "Question", values=c("actual", "perceived"))



data$CTsupport<-matrix(0,length(data$STATUS),1)
data$CMsupport<-matrix(0,length(data$STATUS),1)
data$CTsupport[which(data[,61]>=4)]<-1
data$CMsupport[which(data[,62]>=4)]<-1
data$CTsupportPercent<-matrix(0,length(data$STATUS),1)
data$CMsupportPercent<-matrix(0,length(data$STATUS),1)

for (i in 1:length(data$CPsupport)){
data$CTsupportPercent[i]<-sum(data$CTsupport[which(data$Primary_research_field==data$Primary_research_field[i])])/length(data$CTsupport[which(data$Primary_research_field==data$Primary_research_field[i])])*100

data$CMsupportPercent[i]<-sum(data$CMsupport[which(data$Primary_research_field==data$Primary_research_field[i])])/length(data$CMsupport[which(data$Primary_research_field==data$Primary_research_field[i])])*100
}

data_long<-data[,c(1,16,81,121:122)]
names(data_long)<-c("Response.ID","Discipline","OrderBelief_second","OrderBelief_CTfirst","OrderBelief_CMfirst")
data_long<-reshape(data_long, direction = "long", varying = names(data_long)[3:5], idvar = "Response.ID", sep="_",timevar="Question")



myData <- aggregate(data_long$OrderBelief,
                    by = list(data_long$Discipline,data_long$Question),
                    FUN = function(x) c(mean = mean(x, na.rm=TRUE), sd = sd(x, na.rm=TRUE),n= length(x)))
myData <- do.call(data.frame, myData)
myData$se <- myData$x.sd / sqrt(myData$x.n)
colnames(myData) <- c("Discipline", 'Question',"mean", "sd", "n", "se")


ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Question),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "", y = "Expected vs. actual importance \n of carbon pricing (in %)")+
  geom_point(aes(color = Question), position = position_dodge(0.5)) +
  scale_colour_discrete(name = "", breaks = c("CTfirst", "CMfirst","second"), labels=c("Actual importance of carbon tax", "Actual importance of cap-and-trade","Expected importance"))+
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=50, linetype="dashed", color = "black")+ theme(legend.position="bottom")#+
 # scale_fill_manual(name = "Question", values=c("actual", "perceived"))

palette<-c(rep("green3",15),rep("blue",15),rep("black",15))
ggplot(data = myData, aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = Question),
                position= position_dodge(0.5), width = 0.2) +
  labs(x = "", y = "Expected vs. actual importance \n of carbon pricing (in %)")+
  geom_point(aes(color = Question), position = position_dodge(0.5)) +
 scale_colour_discrete(name = "", breaks=c("CTfirst", "CMfirst","second"), #values=c("green3","blue","black"),  
                       labels=c("Actual importance of carbon tax", "Actual importance of cap-and-trade","Expected importance"))+
  scale_colour_manual(values = c("green3","blue","black"),breaks=c("CTfirst", "CMfirst","second"), #values=c("green3","blue","black"),  
                       labels=c("Actual importance of carbon tax", "Actual importance of cap-and-trade","Expected importance"),name = "")+ 
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1))+
geom_hline(yintercept=50, linetype="dashed", color = "black")+ theme(legend.position="bottom")#+
 # scale_fill_manual(name = "Question", values=c("actual", "perceived"))





p5<-ggplot(data = myData[which(myData$Instrument=="Information provision"),], aes(x = Discipline, y = mean))+ 
  geom_errorbar(aes(ymin = mean-2*se, ymax = mean+2*se, color = palette5)) +
  scale_color_manual(breaks=palette5, values=c("black", "black", "black", "red","black","black","black","black","green3","black","black","black","black", "red","green3")) +
  labs(title="Information provision",x = "", y = "")+
  geom_point(position = position_dodge(0.1), color = palette5) +
  ylim(1.8, 5.0)+
  theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1))+ geom_hline(yintercept=mean(data$importantpolicies_6,na.rm=TRUE), linetype="dashed", color = "black") +
  theme(legend.position="none",
        axis.text.y=element_blank())
```

Here finally I try to explain how well policy is evaluated in a policy mix by the four criteria (effectiveness, efficiency, equiaty and feasibility), the weights scientists assign to these weights and some additional controls

It appears from the results that the general ranking of the four criteria in evaluating policy hear are not so important (low significance and coefficient size). Instead, what is important is how scientists judged instruments in terms of their performance on the four criteria.


If I include both interaction terms and individual effects, significance deteriorates for manz variables.
Testing variance inflation factor shows however that when adding single terms and interaction effects suffers from multicollinearity problems! (coeffecients should be below 5-10)
```{r, echo=FALSE}

Interaction_Dreg_Effe<-data$criteria_1*data$effectiveness_1
Interaction_Dreg_Effi<-data$criteria_2*data$efficiency_1
Interaction_Dreg_Equi<-data$criteria_3*data$equity_1
Interaction_Dreg_Feas<-data$criteria_4*data$feasible_1

Interaction_Ctax_Effe<-data$criteria_1*data$effectiveness_2
Interaction_Ctax_Effi<-data$criteria_2*data$efficiency_2
Interaction_Ctax_Equi<-data$criteria_3*data$equity_2
Interaction_Ctax_Feas<-data$criteria_4*data$feasible_2

Interaction_Cmarket_Effe<-data$criteria_1*data$effectiveness_3
Interaction_Cmarket_Effi<-data$criteria_2*data$efficiency_3
Interaction_Cmarket_Equi<-data$criteria_3*data$equity_3
Interaction_Cmarket_Feas<-data$criteria_4*data$feasible_3

Interaction_Asub_Effe<-data$criteria_1*data$effectiveness_4
Interaction_Asub_Effi<-data$criteria_2*data$efficiency_4
Interaction_Asub_Equi<-data$criteria_3*data$equity_4
Interaction_Asub_Feas<-data$criteria_4*data$feasible_4

Interaction_Inns_Effe<-data$criteria_1*data$effectiveness_5
Interaction_Inns_Effi<-data$criteria_2*data$efficiency_5
Interaction_Inns_Equi<-data$criteria_3*data$equity_5
Interaction_Inns_Feas<-data$criteria_4*data$feasible_5

Interaction_Infp_Effe<-data$criteria_1*data$effectiveness_6
Interaction_Infp_Effi<-data$criteria_2*data$efficiency_6
Interaction_Infp_Equi<-data$criteria_3*data$equity_6
Interaction_Infp_Feas<-data$criteria_4*data$feasible_6

data$GEM_GGrowth<-matrix(0,length(data$STATUS),1)
data$GEM_GGrowth[which(data$GEMcluster==1)]<-1

data$GEM_AGrowth<-matrix(0,length(data$STATUS),1)
data$GEM_AGrowth[which(data$GEMcluster==2)]<-1

data$GEM_DGrowth<-matrix(0,length(data$STATUS),1)
data$GEM_DGrowth[which(data$GEMcluster==3)]<-1

print("importance_Dreg")
m_change <- polr(importance_Dreg ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_1 + efficiency_1 + equity_1 + feasible_1 + #+ Primary_research_field 
     # + Interaction_Dreg_Effe + Interaction_Dreg_Effi + Interaction_Dreg_Equi + Interaction_Dreg_Feas
                   + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics +GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")


m_change <- polr(importance_Dreg ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_1 + efficiency_1 + equity_1 + feasible_1 + #+ Primary_research_field + 
      Interaction_Dreg_Effe + Interaction_Dreg_Effi + Interaction_Dreg_Equi + Interaction_Dreg_Feas
                   + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Ctax")
m_change <- polr(importance_Ctax ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_2 + efficiency_2 + equity_2 + feasible_2 + #+ Primary_research_field 
    #+ Interaction_Ctax_Effe + Interaction_Ctax_Effi + Interaction_Ctax_Equi + Interaction_Ctax_Feas
                 + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")


m_change <- polr(importance_Ctax ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_2 + efficiency_2 + equity_2 + feasible_2 + #+ Primary_research_field + 
    Interaction_Ctax_Effe + Interaction_Ctax_Effi + Interaction_Ctax_Equi + Interaction_Ctax_Feas
                 + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Cmarket")
m_change <- polr(importance_Cmarket ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                   + effectiveness_3 + efficiency_3 + equity_3 + feasible_3 + #+ Primary_research_field 
      #+ Interaction_Cmarket_Effe + Interaction_Cmarket_Effi + Interaction_Cmarket_Equi + Interaction_Cmarket_Feas
+ second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")


m_change <- polr(importance_Cmarket ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                   + effectiveness_3 + efficiency_3 + equity_3 + feasible_3 + #+ Primary_research_field + 
      Interaction_Cmarket_Effe + Interaction_Cmarket_Effi + Interaction_Cmarket_Equi + Interaction_Cmarket_Feas
+ second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Asub")
m_change <- polr(importance_Asub ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_4 + efficiency_4 + equity_4 + feasible_4 + #+ Primary_research_field 
   #+ Interaction_Asub_Effe + Interaction_Asub_Effi + Interaction_Asub_Equi + Interaction_Asub_Feas
+ second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

m_change <- polr(importance_Asub ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_4 + efficiency_4 + equity_4 + feasible_4 + #+ Primary_research_field + 
   Interaction_Asub_Effe + Interaction_Asub_Effi + Interaction_Asub_Equi + Interaction_Asub_Feas
+ second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Inns")
m_change <- polr(importance_Inns ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_5 + efficiency_5 + equity_5 + feasible_5 + #+ Primary_research_field 
    #+ Interaction_Inns_Effe + Interaction_Inns_Effi + Interaction_Inns_Equi + Interaction_Inns_Feas
 + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

m_change <- polr(importance_Inns ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_5 + efficiency_5 + equity_5 + feasible_5 + #+ Primary_research_field + 
    Interaction_Inns_Effe + Interaction_Inns_Effi + Interaction_Inns_Equi + Interaction_Inns_Feas
 + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Infp")
m_change <- polr(importance_Infp ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_6 + efficiency_6 + equity_6 + feasible_6 + #+ Primary_research_field 
#+ Interaction_Infp_Effe + Interaction_Infp_Effi + Interaction_Infp_Equi + Interaction_Infp_Feas
 + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+ DisciplineCluster2 + DisciplineCluster3+  DisciplineCluster5+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")

m_change <- polr(importance_Infp ~ criteria_1 +criteria_2 +criteria_3 +criteria_4 
                 +effectiveness_6 + efficiency_6 + equity_6 + feasible_6 + #+ Primary_research_field + 
Interaction_Infp_Effe + Interaction_Infp_Effi + Interaction_Infp_Equi + Interaction_Infp_Feas
 + second_order_belief_1 + climate_worry + research_experience_1+ gender + politics+GEM_AGrowth+GEM_DGrowth+continent
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)


print("importance_Dreg")
m_change <- polr(importance_Dreg ~ GEM_AGrowth+GEM_DGrowth
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Ctax")
m_change <- polr(importance_Ctax ~ GEM_AGrowth+GEM_DGrowth
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Cmarket")
m_change <- polr(importance_Cmarket ~ GEM_AGrowth+GEM_DGrowth
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Asub")
m_change <- polr(importance_Asub ~ GEM_AGrowth+GEM_DGrowth
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Inns")
m_change <- polr(importance_Inns ~ GEM_AGrowth+GEM_DGrowth
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

print("importance_Infp")
m_change <- polr(importance_Infp ~ GEM_AGrowth+GEM_DGrowth
                 , data = data, Hess=TRUE)
#summary(m_change)
ctable <- coef(summary(m_change))
p <- pnorm(abs(ctable[, "t value"]), lower.tail = FALSE) * 2
(ctable <- cbind(ctable, "p value" = p))
ci <- confint(m_change)
#exp(coef(m_change))
## OR and CI
exp(cbind(OR = coef(m_change), ci))
PseudoR2(m_change,which="Nagelkerke")
car::vif(m_change)

```

```{r, echo=FALSE}


Construct<-matrix(0,nrow(data),7)
Construct<-as.data.frame(Construct)
colnames(Construct)<-c('ID',"Weighted_Dreg","Weighted_Ctax","Weighted_Cmar","Weighted_Asub","Weighted_Inns","Weighted_Infp")
Construct[,1]<-data$CID
Construct[,2]<-(data$criteria_1*data$effectiveness_1+data$criteria_2*data$efficiency_1+
  data$criteria_3*data$equity_1+data$criteria_4*data$feasible_1)
Construct[,3]<-(data$criteria_1*data$effectiveness_2+data$criteria_2*data$efficiency_2+
  data$criteria_3*data$equity_2+data$criteria_4*data$feasible_2)
Construct[,4]<-(data$criteria_1*data$effectiveness_3+data$criteria_2*data$efficiency_3+
  data$criteria_3*data$equity_3+data$criteria_4*data$feasible_3)
Construct[,5]<-(data$criteria_1*data$effectiveness_4+data$criteria_2*data$efficiency_4+
  data$criteria_3*data$equity_4+data$criteria_4*data$feasible_4)
Construct[,6]<-(data$criteria_1*data$effectiveness_5+data$criteria_2*data$efficiency_5+
  data$criteria_3*data$equity_5+data$criteria_4*data$feasible_5)
Construct[,7]<-(data$criteria_1*data$effectiveness_6+data$criteria_2*data$efficiency_6+
  data$criteria_3*data$equity_6+data$criteria_4*data$feasible_6)

Construct$Field<-data$Primary_research_field
Construct$Cluster<-data$DisciplineClusterS


Construct_long<-reshape(Construct, direction = "long", varying = names(Construct)[2:7], idvar = "Response.ID", sep="_",timevar="Question")

data_long<-data[,c(1,16,60:65,104)]
data_long<-reshape(data_long, direction = "long", varying = names(data_long)[3:8], idvar = "Response.ID", sep="_",timevar="Question")

cor.test(Construct_long$Weighted,data_long$importantpolicies)

"Math & comp. sci."
cor.test(Construct_long$Weighted[which(Construct_long$Cluster==1)],data_long$importantpolicies[which(Construct_long$Cluster==1)])
"Env. economics,Law,Oth. economics"
cor.test(Construct_long$Weighted[which(Construct_long$Cluster==2)],data_long$importantpolicies[which(Construct_long$Cluster==2)])
"Agri./forestry...Sust. transition"
cor.test(Construct_long$Weighted[which(Construct_long$Cluster==3)],data_long$importantpolicies[which(Construct_long$Cluster==3)])
"Ecol. economics"
cor.test(Construct_long$Weighted[which(Construct_long$Cluster==4)],data_long$importantpolicies[which(Construct_long$Cluster==4)])
"Sociology & Psychology"
cor.test(Construct_long$Weighted[which(Construct_long$Cluster==5)],data_long$importantpolicies[which(Construct_long$Cluster==5)])
# data$DisciplineClusterS<-matrix(0,length(data$STATUS),1)
# data$DisciplineClusterS[which(data$Primary_research_field %in% c("Agri./forestry","Engineering","Geography","Ind. ecology","Natural sci.","Oth. env. soc. sci.","Political sci.","Sust. transition"))]<-3
# data$DisciplineClusterS[which(data$Primary_research_field %in% c("Ecol. economics"))]<-4
# data$DisciplineClusterS[which(data$Primary_research_field %in% c("Env. economics","Law","Oth. economics"))]<-2
# data$DisciplineClusterS[which(data$Primary_research_field %in% c("Math & comp. sci."))]<-1
# data$DisciplineClusterS[which(data$Primary_research_field %in% c("Sociology","Psychology"))]<-5

```

